<!DOCTYPE html>
<html lang="en">
<head>
  <title>Get TikTok Account Location Finder | Full Profile Details</title>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <meta name="description" content="Our TikTok Location Finder helps you discover TikTok account locations by username. Get full profile details, Free, accurate, and easy to use!">
  <meta name="keywords" content="TikTok location finder, معرفة موقع تيك توك, معرفة حساب تيك توك  معرفة موقع حساب تيكتوك, Find TikTok Influencers by Location, Tiktok Location Scraper, بوت تحديد موقع تيك توك, كيف يمكنني تحديد موقع حسابي على تيك توك؟, كيف تعرف صاحب حساب التيك توك؟, كيفية العثور على معلومات حساب TikTok؟, How do I find local TikTok users, How do I find a specific TikTok user, How do I look up an account on TikTok, Find TikTok User ID, Free Tiktok search tool, TikTok User Search Tool, account statistics for any TikTok user, tiktok profile lookup, tiktok lookup, tiktok account search, find TikTok user location, TikTok account location, TikTok username location, FAQ TikTok tool, About TikTok location tool, TikTok geolocation, TikTok user location search, Locate TikTok account by username, TikTok profile location, Free TikTok location finder, How to find TikTok user location, TikTok account details, TikTok stats checker">
  <meta name="author" content="@mo.or__">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://tikip.us/"/>

  <meta property="og:title" content="TikTok Account Location Finder | Full Profile Details & FAQ">
  <meta property="og:description" content="Use our free TikTok Location Finder to get full profile details, including location, by username. Learn more about the tool and find answers in our FAQ.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tikip.us">
  <meta property="og:image" content="https://tikip.us/favicon.png">
  <meta property="og:site_name" content="TikTok Location Finder">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@mo.or__">
  <meta name="twitter:title" content="TikTok Account Location Finder | Full Profile Details & FAQ">
  <meta name="twitter:description" content="Free tool to find TikTok user locations and full profile details by username. Check out our FAQ and learn more about how it works.">
  <meta name="twitter:image" content="https://tikip.us/favicon.png">
  <meta content="Global" name="distribution"/>
  <meta content="General" name="rating"/>
  <meta content="en" http-equiv="content-language"/>
  <meta content="Turkey" name="geo.country"/>
  <meta content="en_US" property="og:locale"/>
  <meta content="en_UK" property="og:locale:alternate"/>
  <meta content="Turkey" name="geo.placename"/>

  <!-- Google Fonts and Tailwind CSS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="/favicon.png" type="image/png">
  
  <!-- Scripts -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HTPQL6DM82"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HTPQL6DM82');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6346556035067219" crossorigin="anonymous"></script>
  <meta name="google-site-verification" content="B3Dexm1A96g9Vj5uQ3LjOOsA-RxFqSwca_G0LrOchB0" />
  <meta name="monetag" content="caa90b8bc2e2b44cb2ca5427c3072138">
  
  <!-- API Config (ensure this file exists or functionality will break) -->
  <script src="api_config.js"></script>

  <!-- JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "TikTok Account Location Finder & FAQ",
    "url": "https://tikip.us/",
    "description": "A free online tool to find TikTok account locations and full profile details by username. Includes an FAQ section for common questions.",
    "creator": {
      "@type": "Person",
      "name": "@mo.or__"
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://tikip.us/?username={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "TikTok Account Location Finder",
    "applicationCategory": "SocialNetworkAnalysisTool",
    "operatingSystem": "Web",
    "browserRequirements": "Requires a modern web browser with JavaScript enabled.",
    "description": "Free web-based tool to retrieve public TikTok user profile details, including estimated location, bio, follower counts, and video statistics by username. Learn more about the tool and see our FAQ.",
    "url": "https://tikip.us/",
    "author": {
      "@type": "Person",
      "name": "@mo.or__"
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>

  <style>
    /* Minimalist Design Custom Styles */
    :root {
        --bg-light: #ffffff;
        --bg-dark: #111111;
        --text-light: #111111;
        --text-dark: #eeeeee;
        --text-secondary-light: #666666;
        --text-secondary-dark: #999999;
        --border-light: #e5e5e5;
        --border-dark: #333333;
        --accent-color: #3b82f6; /* A nice blue */
        --card-bg-light: #ffffff;
        --card-bg-dark: #1c1c1c;
        --font-sans: 'Inter', sans-serif;
        --font-mono: 'Roboto Mono', monospace;
    }

    html.dark {
        --bg: var(--bg-dark);
        --text-primary: var(--text-dark);
        --text-secondary: var(--text-secondary-dark);
        --border-color: var(--border-dark);
        --card-bg: var(--card-bg-dark);
    }
    html:not(.dark) {
        --bg: var(--bg-light);
        --text-primary: var(--text-light);
        --text-secondary: var(--text-secondary-light);
        --border-color: var(--border-light);
        --card-bg: var(--card-bg-light);
    }
    
    body {
        font-family: var(--font-sans);
        background-color: var(--bg);
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
        font-family: var(--font-mono);
    }

    .minimal-card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 1rem;
        transition: background-color 0.3s ease, border-color 0.3s ease;
    }
    
    .minimal-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.625rem 1.25rem; /* 10px 20px */
        border-radius: 0.5rem; /* 8px */
        font-weight: 500;
        transition: background-color 0.2s ease, color 0.2s ease;
        border: 1px solid transparent;
    }
    .minimal-btn.primary {
        background-color: var(--accent-color);
        color: white;
    }
    .minimal-btn.primary:hover {
        background-color: #2563eb;
    }
    .minimal-btn.secondary {
        background-color: transparent;
        color: var(--text-primary);
        border-color: var(--border-color);
    }
     .minimal-btn.secondary:hover {
        background-color: var(--border-color);
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .loading-spinner {
        animation: spin 1s linear infinite;
    }
    
    .page-content.active {
      display: block;
    }
  </style>

</head>
<body class="antialiased">
  
  <div class="relative min-h-screen w-full flex flex-col items-center p-4 sm:p-6 lg:p-8">
    <button id="theme-toggle" class="absolute top-4 right-4 p-2 rounded-full" aria-label="Toggle theme" style="color: var(--text-secondary);">
        <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg>
    </button>
    <div class="flex-grow w-full flex items-center justify-center">
        <div class="container w-full max-w-2xl mx-auto">
    
            <main class="w-full">
                <!-- Main Search Page -->
                <div class="page-content active" id="main-page">
                  <header class="text-center py-8">
                    <h1 class="text-3xl sm:text-4xl font-bold tracking-tight" style="color: var(--text-primary);">
                      TikTok Location Finder
                    </h1>
                    <p class="mt-3 text-sm" style="color: var(--text-secondary);">Created by <a href="https://www.tiktok.com/@mo.or__" target="_blank" rel="noopener" class="font-medium text-blue-500 hover:underline">@_moro.__</a></p>
                  </header>
                  
                  <section class="minimal-card p-6 sm:p-8">
                    <h2 id="search-tool-heading" class="text-lg font-semibold mb-4 text-center" style="color: var(--text-primary);">Find a TikTok Profile</h2>
                    <div class="space-y-4">
                        <div class="relative">
                          <input type="text" id="username" placeholder="Enter TikTok username (without @)" required aria-label="TikTok Username Input" class="w-full px-4 py-3 text-base rounded-md border-2 transition-colors duration-200" style="background-color: var(--bg); border-color: var(--border-color); color: var(--text-primary); focus:border-color: var(--accent-color); focus:ring:0;">
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                          <button id="getResultsBtn" aria-label="Search TikTok profile" class="minimal-btn primary w-full">Get Profile Details</button>
                          <button id="supportBtn" aria-label="Support the creator" class="minimal-btn secondary w-full">Support Our Work ❤</button>
                        </div>
                    </div>
                  </section>
                  
                  <div id="result" class="mt-8" aria-live="polite"></div>

                  <section class="mt-12">
                      <h2 class="text-xl font-bold text-center mb-6">About & FAQ</h2>
                      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <article class="minimal-card p-6" aria-labelledby="about-tool-heading">
                            <h3 id="about-tool-heading" class="text-md font-semibold mb-2" style="color: var(--text-primary);">About This Tool</h3>
                            <p class="text-sm" style="color: var(--text-secondary);">This <strong>TikTok Location Finder</strong> is a free tool designed to help you retrieve complete public TikTok user profiles. With our <strong>TikTok profile lookup</strong> service, you can easily <strong>find TikTok user location</strong> information, along with other <strong>TikTok account details</strong>.</p>
                        </article>
                        <article class="minimal-card p-6" aria-labelledby="faq-heading">
                            <h3 id="faq-heading" class="text-md font-semibold mb-2" style="color: var(--text-primary);">FAQ</h3>
                            <p class="text-sm" style="color: var(--text-secondary);"><strong>How does it work?</strong> Our tool fetches publicly available TikTok profile information using the username you provide. This includes data such as their display name, bio, follower counts, and an estimated country or region.</p>
                        </article>
                      </div>
                  </section>
                </div>
            </main>

            <footer class="footer mt-16 text-center py-6">
                <nav class="footer-nav flex flex-wrap justify-center gap-x-6 gap-y-2" aria-label="Footer navigation">
                  <a href="#" class="text-xs font-medium" style="color: var(--text-secondary);">Home</a>
                  <a href="#" class="text-xs font-medium" style="color: var(--text-secondary);">About Us</a>
                  <a href="#" class="text-xs font-medium" style="color: var(--text-secondary);">Contact</a>
                  <a href="#" class="text-xs font-medium" style="color: var(--text-secondary);">Privacy</a>
                  <a href="#" class="text-xs font-medium" style="color: var(--text-secondary);">Terms</a>
                </nav>
            </footer>
        </div>
    </div>
  </div>

  <script>
    // ===== THEME TOGGLE LOGIC ===== //
    const themeToggle = document.getElementById('theme-toggle');
    const sunIcon = document.getElementById('theme-icon-sun');
    const moonIcon = document.getElementById('theme-icon-moon');
    const htmlEl = document.documentElement;

    function applyTheme(theme) {
        if (theme === 'dark') {
            htmlEl.classList.add('dark');
            sunIcon.classList.add('hidden');
            moonIcon.classList.remove('hidden');
        } else {
            htmlEl.classList.remove('dark');
            sunIcon.classList.remove('hidden');
            moonIcon.classList.add('hidden');
        }
    }

    // Check for saved theme in localStorage or system preference
    const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(savedTheme);

    themeToggle.addEventListener('click', () => {
        const isDark = htmlEl.classList.contains('dark');
        const newTheme = isDark ? 'light' : 'dark';
        localStorage.setItem('theme', newTheme);
        applyTheme(newTheme);
    });
    
    // ===== PAGE NAVIGATION LOGIC (Simplified for single-page experience) ===== //
    // In this minimalist design, other pages are omitted for simplicity.
    // If needed, the previous page navigation logic can be re-added here.

    // ===== API & USER LOOKUP LOGIC ===== //
    function getCountryFlag(country) {
      const flagMap = {
        'AD': '🇦🇩', 'Andorra': '🇦🇩', 'AE': '🇦🇪', 'United Arab Emirates': '🇦🇪', 'AF': '🇦🇫', 'Afghanistan': '🇦🇫', 'AG': '🇦🇬', 'Antigua and Barbuda': '🇦🇬', 'AI': '🇦🇮', 'Anguilla': '🇦🇮', 'AL': '🇦🇱', 'Albania': '🇦🇱', 'AM': '🇦🇲', 'Armenia': '🇦🇲', 'AO': '🇦🇴', 'Angola': '🇦🇴', 'AQ': '🇦🇶', 'Antarctica': '🇦🇶', 'AR': '🇦🇷', 'Argentina': '🇦🇷', 'AS': '🇦🇸', 'American Samoa': '🇦🇸', 'AT': '🇦🇹', 'Austria': '🇦🇹', 'AU': '🇦🇺', 'Australia': '🇦🇺', 'AW': '🇦🇼', 'Aruba': '🇦🇼', 'AX': '🇦🇽', 'Åland Islands': '🇦🇽', 'AZ': '🇦🇿', 'Azerbaijan': '🇦🇿', 'BA': '🇧🇦', 'Bosnia and Herzegovina': '🇧🇦', 'BB': '🇧🇧', 'Barbados': '🇧🇧', 'BD': '🇧🇩', 'Bangladesh': '🇧🇩', 'BE': '🇧🇪', 'Belgium': '🇧🇪', 'BF': '🇧🇫', 'Burkina Faso': '🇧🇫', 'BG': '🇧🇬', 'Bulgaria': '🇧🇬', 'BH': '🇧🇭', 'Bahrain': '🇧🇭', 'BI': '🇧🇮', 'Burundi': '🇧🇮', 'BJ': '🇧🇯', 'Benin': '🇧🇯', 'BL': '🇧🇱', 'Saint Barthélemy': '🇧🇱', 'BM': '🇧🇲', 'Bermuda': '🇧🇲', 'BN': '🇧🇳', 'Brunei Darussalam': '🇧🇳', 'BO': '🇧🇴', 'Bolivia': '🇧🇴', 'BQ': '🇧🇶', 'Bonaire, Sint Eustatius and Saba': '🇧🇶', 'BR': '🇧🇷', 'Brazil': '🇧🇷', 'BS': '🇧🇸', 'Bahamas': '🇧🇸', 'BT': '🇧🇹', 'Bhutan': '🇧🇹', 'BV': '🇧🇻', 'Bouvet Island': '🇧🇻', 'BW': '🇧🇼', 'Botswana': '🇧🇼', 'BY': '🇧🇾', 'Belarus': '🇧🇾', 'BZ': '🇧🇿', 'Belize': '🇧🇿', 'CA': '🇨🇦', 'Canada': '🇨🇦', 'CC': '🇨🇨', 'Cocos (Keeling) Islands': '🇨🇨', 'CD': '🇨🇩', 'Congo, Democratic Republic of the': '🇨🇩', 'CF': '🇨🇫', 'Central African Republic': '🇨🇫', 'CG': '🇨🇬', 'Congo, Republic of the': '🇨🇬', 'CH': '🇨🇭', 'Switzerland': '🇨🇭', 'CI': '🇨🇮', "Côte D'Ivoire": '🇨🇮', 'CK': '🇨🇰', 'Cook Islands': '🇨🇰', 'CL': '🇨🇱', 'Chile': '🇨🇱', 'CM': '🇨🇲', 'Cameroon': '🇨🇲', 'CN': '🇨🇳', 'China': '🇨🇳', 'CO': '🇨🇴', 'Colombia': '🇨🇴', 'CR': '🇨🇷', 'Costa Rica': '🇨🇷', 'CU': '🇨🇺', 'Cuba': '🇨🇺', 'CV': '🇨🇻', 'Cape Verde': '🇨🇻', 'CW': '🇨🇼', 'Curaçao': '🇨🇼', 'CX': '🇨🇽', 'Christmas Island': '🇨🇽', 'CY': '🇨🇾', 'Cyprus': '🇨🇾', 'CZ': '🇨🇿', 'Czech Republic': '🇨🇿', 'DE': '🇩🇪', 'Germany': '🇩🇪', 'DJ': '🇩🇯', 'Djibouti': '🇩🇯', 'DK': '🇩🇰', 'Denmark': '🇩🇰', 'DM': '🇩🇲', 'Dominica': '🇩🇲', 'DO': '🇩🇴', 'Dominican Republic': '🇩🇴', 'DZ': '🇩🇿', 'Algeria': '🇩🇿', 'EC': '🇪🇨', 'Ecuador': '🇪🇨', 'EE': '🇪🇪', 'Estonia': '🇪🇪', 'EG': '🇪🇬', 'Egypt': '🇪🇬', 'EH': '🇪🇭', 'Western Sahara': '🇪🇭', 'ER': '🇪🇷', 'Eritrea': '🇪🇷', 'ES': '🇪🇸', 'Spain': '🇪🇸', 'ET': '🇪🇹', 'Ethiopia': '🇪🇹', 'FI': '🇫🇮', 'Finland': '🇫🇮', 'FJ': '🇫🇯', 'Fiji': '🇫🇯', 'FK': '🇫🇰', 'Falkland Islands (Malvinas)': '🇫🇰', 'FM': '🇫🇲', 'Micronesia, Federated States of': '🇫🇲', 'FO': '🇫🇴', 'Faroe Islands': '🇫🇴', 'FR': '🇫🇷', 'France': '🇫🇷', 'GA': '🇬🇦', 'Gabon': '🇬🇦', 'GB': '🇬🇧', 'United Kingdom': '🇬🇧', 'UK': '🇬🇧', 'GD': '🇬🇩', 'Grenada': '🇬🇩', 'GE': '🇬🇪', 'Georgia': '🇬🇪', 'GF': '🇬🇫', 'French Guiana': '🇬🇫', 'GG': '🇬🇬', 'Guernsey': '🇬🇬', 'GH': '🇬🇭', 'Ghana': '🇬🇭', 'GI': '🇬🇮', 'Gibraltar': '🇬🇮', 'GL': '🇬🇱', 'Greenland': '🇬🇱', 'GM': '🇬🇲', 'Gambia': '🇬🇲', 'GN': '🇬🇳', 'Guinea': '🇬🇳', 'GP': '🇬🇵', 'Guadeloupe': '🇬🇵', 'GQ': '🇬🇶', 'Equatorial Guinea': '🇬🇶', 'GR': '🇬🇷', 'Greece': '🇬🇷', 'GS': '🇬🇸', 'South Georgia and the South Sandwich Islands': '🇬🇸', 'GT': '🇬🇹', 'Guatemala': '🇬🇹', 'GU': '🇬🇺', 'Guam': '🇬🇺', 'GW': '🇬🇼', 'Guinea-Bissau': '🇬🇼', 'GY': '🇬🇾', 'Guyana': '🇬🇾', 'HK': '🇭🇰', 'Hong Kong': '🇭🇰', 'HM': '🇭🇲', 'Heard Island and McDonald Islands': '🇭🇲', 'HN': '🇭🇳', 'Honduras': '🇭🇳', 'HR': '🇭🇷', 'Croatia': '🇭🇷', 'HT': '🇭🇹', 'Haiti': '🇭🇹', 'HU': '🇭🇺', 'Hungary': '🇭🇺', 'ID': '🇮🇩', 'Indonesia': '🇮🇩', 'IE': '🇮🇪', 'Ireland': '🇮🇪', 'IL': '🇮🇱', 'Israel': '🇮🇱', 'IM': '🇮🇲', 'Isle of Man': '🇮🇲', 'IN': '🇮🇳', 'India': '🇮🇳', 'IO': '🇮🇴', 'British Indian Ocean Territory': '🇮🇴', 'IQ': '🇮🇶', 'Iraq': '🇮🇶', 'IR': '🇮🇷', 'Iran, Islamic Republic of': '🇮🇷', 'IS': '🇮🇸', 'Iceland': '🇮🇸', 'IT': '🇮🇹', 'Italy': '🇮🇹', 'JE': '🇯🇪', 'Jersey': '🇯🇪', 'JM': '🇯🇲', 'Jamaica': '🇯🇲', 'JO': '🇯🇴', 'Jordan': '🇯🇴', 'JP': '🇯🇵', 'Japan': '🇯🇵', 'KE': '🇰🇪', 'Kenya': '🇰🇪', 'KG': '🇰🇬', 'Kyrgyzstan': '🇰🇬', 'KH': '🇰🇭', 'Cambodia': '🇰🇭', 'KI': '🇰🇮', 'Kiribati': '🇰🇮', 'KM': '🇰🇲', 'Comoros': '🇰🇲', 'KN': '🇰🇳', 'Saint Kitts and Nevis': '🇰🇳', 'KP': '🇰🇵', "Korea, Democratic People's Republic of": '🇰🇵', 'KR': '🇰🇷', 'Korea, Republic of': '🇰🇷', 'KW': '🇰🇼', 'Kuwait': '🇰🇼', 'KY': '🇰🇾', 'Cayman Islands': '🇰🇾', 'KZ': '🇰🇿', 'Kazakhstan': '🇰🇿', 'LA': '🇱🇦', "Lao People's Democratic Republic": '🇱🇦', 'LB': '🇱🇧', 'Lebanon': '🇱🇧', 'LC': '🇱🇨', 'Saint Lucia': '🇱🇨', 'LI': '🇱🇮', 'Liechtenstein': '🇱🇮', 'LK': '🇱🇰', 'Sri Lanka': '🇱🇰', 'LR': '🇱🇷', 'Liberia': '🇱🇷', 'LS': '🇱🇸', 'Lesotho': '🇱🇸', 'LT': '🇱🇹', 'Lithuania': '🇱🇹', 'LU': '🇱🇺', 'Luxembourg': '🇱🇺', 'LV': '🇱🇻', 'Latvia': '🇱🇻', 'LY': '🇱🇾', 'Libya': '🇱🇾', 'MA': '🇲🇦', 'Morocco': '🇲🇦', 'MC': '🇲🇨', 'Monaco': '🇲🇨', 'MD': '🇲🇩', 'Moldova, Republic of': '🇲🇩', 'ME': '🇲🇪', 'Montenegro': '🇲🇪', 'MF': '🇲🇫', 'Saint Martin (French part)': '🇲🇫', 'MG': '🇲🇬', 'Madagascar': '🇲🇬', 'MH': '🇲🇭', 'Marshall Islands': '🇲🇭', 'MK': '🇲🇰', 'North Macedonia': '🇲🇰', 'ML': '🇲🇱', 'Mali': '🇲🇱', 'MM': '🇲🇲', 'Myanmar': '🇲🇲', 'MN': '🇲🇳', 'Mongolia': '🇲🇳', 'MO': '🇲🇴', 'Macao': '🇲🇴', 'MP': '🇲🇵', 'Northern Mariana Islands': '🇲🇵', 'MQ': '🇲🇶', 'Martinique': '🇲🇶', 'MR': '🇲🇷', 'Mauritania': '🇲🇷', 'MS': '🇲🇸', 'Montserrat': '🇲🇸', 'MT': '🇲🇹', 'Malta': '🇲🇹', 'MU': '🇲🇺', 'Mauritius': '🇲🇺', 'MV': '🇲🇻', 'Maldives': '🇲🇻', 'MW': '🇲🇼', 'Malawi': '🇲🇼', 'MX': '🇲🇽', 'Mexico': '🇲🇽', 'MY': '🇲🇾', 'Malaysia': '🇲🇾', 'MZ': '🇲🇿', 'Mozambique': '🇲🇿', 'NA': '🇳🇦', 'Namibia': '🇳🇦', 'NC': '🇳🇨', 'New Caledonia': '🇳🇨', 'NE': '🇳🇪', 'Niger': '🇳🇪', 'NF': '🇳🇫', 'Norfolk Island': '🇳🇫', 'NG': '🇳🇬', 'Nigeria': '🇳🇬', 'NI': '🇳🇮', 'Nicaragua': '🇳🇮', 'NL': '🇳🇱', 'Netherlands': '🇳🇱', 'NO': '🇳🇴', 'Norway': '🇳🇴', 'NP': '🇳🇵', 'Nepal': '🇳🇵', 'NR': '🇳🇷', 'Nauru': '🇳🇷', 'NU': '🇳🇺', 'Niue': '🇳🇺', 'NZ': '🇳🇿', 'New Zealand': '🇳🇿', 'OM': '🇴🇲', 'Oman': '🇴🇲', 'PA': '🇵🇦', 'Panama': '🇵🇦', 'PE': '🇵🇪', 'Peru': '🇵🇪', 'PF': '🇵🇫', 'French Polynesia': '🇵🇫', 'PG': '🇵🇬', 'Papua New Guinea': '🇵🇬', 'PH': '🇵🇭', 'Philippines': '🇵🇭', 'PK': '🇵🇰', 'Pakistan': '🇵🇰', 'PL': '🇵🇱', 'Poland': '🇵🇱', 'PM': '🇵🇲', 'Saint Pierre and Miquelon': '🇵🇲', 'PN': '🇵🇳', 'Pitcairn': '🇵🇳', 'PR': '🇵🇷', 'Puerto Rico': '🇵🇷', 'PS': '🇵🇸', 'Palestine, State of': '🇵🇸', 'PT': '🇵🇹', 'Portugal': '🇵🇹', 'PW': '🇵🇼', 'Palau': '🇵🇼', 'PY': '🇵🇾', 'Paraguay': '🇵🇾', 'QA': '🇶🇦', 'Qatar': '🇶🇦', 'RE': '🇷🇪', 'Réunion': '🇷🇪', 'RO': '🇷🇴', 'Romania': '🇷🇴', 'RS': '🇷🇸', 'Serbia': '🇷🇸', 'RU': '🇷🇺', 'Russian Federation': '🇷🇺', 'Russia': '🇷🇺', 'RW': '🇷🇼', 'Rwanda': '🇷🇼', 'SA': '🇸🇦', 'Saudi Arabia': '🇸🇦', 'SB': '🇸🇧', 'Solomon Islands': '🇸🇧', 'SC': '🇸🇨', 'Seychelles': '🇸🇨', 'SD': '🇸🇩', 'Sudan': '🇸🇩', 'SE': '🇸🇪', 'Sweden': '🇸🇪', 'SG': '🇸🇬', 'Singapore': '🇸🇬', 'SH': '🇸🇭', 'Saint Helena, Ascension and Tristan da Cunha': '🇸🇭', 'SI': '🇸🇮', 'Slovenia': '🇸🇮', 'SJ': '🇸🇯', 'Svalbard and Jan Mayen': '🇸🇯', 'SK': '🇸🇰', 'Slovakia': '🇸🇰', 'SL': '🇸🇱', 'Sierra Leone': '🇸🇱', 'SM': '🇸🇲', 'San Marino': '🇸🇲', 'SN': '🇸🇳', 'Senegal': '🇸🇳', 'SO': '🇸🇴', 'Somalia': '🇸🇴', 'SR': '🇸🇷', 'Suriname': '🇸🇷', 'SS': '🇸🇸', 'South Sudan': '🇸🇸', 'ST': '🇸🇹', 'Sao Tome and Principe': '🇸🇹', 'SV': '🇸🇻', 'El Salvador': '🇸🇻', 'SX': '🇸🇽', 'Sint Maarten (Dutch part)': '🇸🇽', 'SY': '🇸🇾', 'Syrian Arab Republic': '🇸🇾', 'SZ': '🇸🇿', 'Eswatini': '🇸🇿', 'TC': '🇹🇨', 'Turks and Caicos Islands': '🇹🇨', 'TD': '🇹🇩', 'Chad': '🇹🇩', 'TF': '🇹🇫', 'French Southern Territories': '🇹🇫', 'TG': '🇹🇬', 'Togo': '🇹🇬', 'TH': '🇹🇭', 'Thailand': '🇹🇭', 'TJ': '🇹🇯', 'Tajikistan': '🇹🇯', 'TK': '🇹🇰', 'Tokelau': '🇹🇰', 'TL': '🇹🇱', 'Timor-Leste': '🇹🇱', 'TM': '🇹🇲', 'Turkmenistan': '🇹🇲', 'TN': '🇹🇳', 'Tunisia': '🇹🇳', 'TO': '🇹🇴', 'Tonga': '🇹🇴', 'TR': '🇹🇷', 'Turkey': '🇹🇷', 'TT': '🇹🇹', 'Trinidad and Tobago': '🇹🇹', 'TV': '🇹🇻', 'Tuvalu': '🇹🇻', 'TW': '🇹🇼', 'Taiwan, Province of China': '🇹🇼', 'TZ': '🇹🇿', 'Tanzania, United Republic of': '🇹🇿', 'UA': '🇺🇦', 'Ukraine': '🇺🇦', 'UG': '🇺🇬', 'Uganda': '🇺🇬', 'UM': '🇺🇲', 'United States Minor Outlying Islands': '🇺🇲', 'US': '🇺🇸', 'United States of America': '🇺🇸', 'USA': '🇺🇸', 'UY': '🇺🇾', 'Uruguay': '🇺🇾', 'UZ': '🇺🇿', 'Uzbekistan': '🇺🇿', 'VA': '🇻🇦', 'Holy See (Vatican City State)': '🇻🇦', 'VC': '🇻🇨', 'Saint Vincent and the Grenadines': '🇻🇨', 'VE': '🇻🇪', 'Venezuela, Bolivarian Republic of': '🇻🇪', 'VG': '🇻🇬', 'Virgin Islands, British': '🇻🇬', 'VI': '🇻🇮', 'Virgin Islands, U.S.': '🇻🇮', 'VN': '🇻🇳', 'Viet Nam': '🇻🇳', 'VU': '🇻🇺', 'Vanuatu': '🇻🇺', 'WF': '🇼🇫', 'Wallis and Futuna': '🇼🇫', 'WS': '🇼🇸', 'Samoa': '🇼🇸', 'XK': '🇽🇰', 'Kosovo': '🇽🇰', 'YE': '🇾🇪', 'Yemen': '🇾🇪', 'YT': '🇾🇹', 'Mayotte': '🇾🇹', 'ZA': '🇿🇦', 'South Africa': '🇿🇦', 'ZM': '🇿🇲', 'Zambia': '🇿🇲', 'ZW': '🇿🇼', 'Palestine': '🇵🇸'
      };
      if (!country) return '🌐';
      const normalizedCountry = String(country).trim();
      for (const key in flagMap) {
        if (key.toLowerCase() === normalizedCountry.toLowerCase()) {
          return flagMap[key];
        }
      }
      return '🌐';
    }

    const getResultsBtn = document.getElementById('getResultsBtn');
    const supportBtn = document.getElementById('supportBtn');
    const usernameInputGlobal = document.getElementById('username');

    if (getResultsBtn) getResultsBtn.addEventListener('click', lookupUser);
    if (supportBtn) supportBtn.addEventListener('click', () => window.open('https://ko-fi.com/moroccan', '_blank'));
    if (usernameInputGlobal) {
      usernameInputGlobal.addEventListener('keypress', e => {
        if (e.key === 'Enter') {
          e.preventDefault();
          lookupUser();
        }
      });
    }

    function createMessage(text, type = 'error') {
        const bgColor = type === 'success' ? 'bg-green-500/20' : 'bg-red-500/20';
        const textColor = type === 'success' ? 'text-green-300' : 'text-red-300';
        return `<div class="minimal-card p-4 text-center ${bgColor} ${textColor} font-semibold">${text}</div>`;
    }
    
    function lookupUser() {
      const resultDiv = document.getElementById('result');
      const username = usernameInputGlobal ? usernameInputGlobal.value.trim() : '';

      if (!username) {
        if(resultDiv) resultDiv.innerHTML = createMessage('Please enter a valid TikTok username.');
        return;
      }

      if (typeof API_CONFIG === 'undefined' || typeof getApiUrl === 'undefined') {
        if(resultDiv) resultDiv.innerHTML = createMessage('API configuration error. Please contact support.');
        return;
      }

      getResultsBtn.disabled = true;
      getResultsBtn.innerHTML = `<svg class="loading-spinner h-5 w-5 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;

      const apiUrl = getApiUrl(username);
      if (!apiUrl) {
        if(resultDiv) resultDiv.innerHTML = createMessage('Could not construct API URL.');
        getResultsBtn.disabled = false;
        getResultsBtn.innerText = 'Get Profile Details';
        return;
      }

      fetch(apiUrl)
        .then(response => {
          if (!response.ok) {
            return response.text().then(text => {
                let errorMsg = `API Error: Status ${response.status}`;
                if (response.status === 429) errorMsg = 'Rate limit exceeded. Try again later.';
                else if (response.status === 404) errorMsg = 'User not found or API endpoint issue.';
                else { try { const d = JSON.parse(text); errorMsg = d.message || d.error || text; } catch (e) { errorMsg = text || errorMsg; }}
                throw new Error(errorMsg);
            });
          }
          return response.json();
        })
        .then(data => {
          const apiProfile = data.profile || data;

          if (apiProfile && typeof apiProfile === 'object' && Object.keys(apiProfile).length > 0) {
            const sanitize = str => (typeof str !== 'string') ? (str ?? '') : str.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            
            let foundProfilePhotoUrl = '';
            const avatarKeys = ['Profile Photo', 'Avatar URL', 'avatar_url', 'avatarUrl', 'picture', 'profileImageUrl', 'profile_pic_url', 'profile_image_url', 'avatar', 'Avatar', 'profile_picture', 'photo_url', 'user_avatar'];
            for (const key of avatarKeys) {
                if (apiProfile[key] && typeof apiProfile[key] === 'string' && apiProfile[key].trim() !== '') {
                    foundProfilePhotoUrl = apiProfile[key];
                    break;
                }
            }
            const profilePhoto = sanitize(foundProfilePhotoUrl);
            
            let rawUsernameFromAPI = apiProfile.Username || apiProfile.username || apiProfile.user_name || apiProfile.unique_id || username;
            if (typeof rawUsernameFromAPI === 'string' && rawUsernameFromAPI.startsWith('@')) {
                rawUsernameFromAPI = rawUsernameFromAPI.substring(1);
            }
            const displayUsername = sanitize(rawUsernameFromAPI);
            const displayNickname = sanitize(apiProfile.Nickname || apiProfile.nickname || apiProfile.name || apiProfile.display_name || apiProfile.user_display_name || displayUsername);

            // --- DATA HANDLING ---
            const details = {};
            let bio = '';
            
            const bioKeys = ['bio', 'description', 'signature'];
            const ignoredKeys = ['nickname','username','name','display_name','user_name','unique_id', 'secuid', 'lastmodified', 'follower', 'following', 'like', 'digg', 'video', 'heart', 'website', 'bio_link', 'url', ...avatarKeys.map(k => k.toLowerCase())];

            for (const key in apiProfile) {
                if (!Object.hasOwnProperty.call(apiProfile, key) || apiProfile[key] == null || String(apiProfile[key]).trim() === '') continue;
                const lowerKey = key.toLowerCase();
                if (bioKeys.some(bioKey => lowerKey.includes(bioKey))) {
                    bio = apiProfile[key];
                } else if (!ignoredKeys.some(ignoredKey => lowerKey.includes(ignoredKey))) {
                    details[key] = apiProfile[key];
                }
            }
            
            // --- BUILD DETAILS HTML ---
            let detailsHtml = '';
            if (Object.keys(details).length > 0) {
                detailsHtml += '<div class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-5">';
                for (const key in details) {
                    let value = details[key];
                    let displayKey = key.replace(/([A-Z])/g, ' $1').replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()).trim();
                    let valueHtml;

                    if (['country', 'region', 'location'].some(k => key.toLowerCase().includes(k))) {
                        valueHtml = `${getCountryFlag(value)} ${sanitize(String(value)) || 'N/A'}`;
                    } else if (typeof value === 'boolean') {
                        valueHtml = value ? '<span class="font-medium text-green-400">Yes</span>' : '<span class="font-medium text-red-400">No</span>';
                    } else if (typeof value === 'string' && value.startsWith('http')) {
                        valueHtml = `<a href="${sanitize(value)}" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:underline break-all">${sanitize(value)}</a>`;
                    } else {
                        valueHtml = sanitize(String(value)) || 'N/A';
                    }
                    detailsHtml += `<div class="text-sm"><div class="font-semibold" style="color: var(--text-primary);">${displayKey}</div><div class="mt-1" style="color: var(--text-secondary);">${valueHtml}</div></div>`;
                }
                detailsHtml += '</div>';
            }

            // --- BUILD BIO HTML ---
            let bioHtml = '';
            if (bio) {
                 const urlRegex = /(https?:\/\/[^\s]+)/g;
                 const sanitizedBio = sanitize(String(bio)).replace(urlRegex, '<a href="$&" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:underline">$&</a>');
                bioHtml = `<div class="mt-6 pt-6 border-t" style="border-color: var(--border-color);">
                    <h4 class="font-semibold text-md mb-2 text-left" style="color: var(--text-primary);">Bio</h4>
                    <p class="text-sm whitespace-pre-wrap text-left" style="color: var(--text-secondary); line-height: 1.6;">${sanitizedBio.replace(/\n/g, '<br>')}</p>
                </div>`;
            }

            const formattedData = `
              <article class="minimal-card p-6 sm:p-8" aria-labelledby="profile-card-heading-${displayUsername}">
                <div class="flex flex-col sm:flex-row items-center text-center sm:text-left gap-5">
                   <div class="relative flex-shrink-0">
                      <img src="${profilePhoto}" alt="Profile photo of ${displayNickname}" class="h-20 w-20 sm:h-24 sm:w-24 rounded-full object-cover border-2" style="border-color: var(--border-color);" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                      <div class="h-20 w-20 sm:h-24 sm:w-24 rounded-full flex items-center justify-center" style="background-color: var(--border-color); display:none;">
                        <svg class="h-10 w-10" style="color: var(--text-secondary);" fill="currentColor" viewBox="0 0 24 24"><path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.998a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                      </div>
                    </div>
                    <div class="flex-grow">
                        <h3 class="text-xl sm:text-2xl font-bold" style="color: var(--text-primary);">${displayNickname}</h3>
                        <p class="text-sm font-mono mt-1" style="color: var(--text-secondary);">${displayUsername.startsWith('@') ? displayUsername : '@' + displayUsername}</p>
                    </div>
                </div>
                ${detailsHtml ? `<div class="my-6 h-px" style="background-color: var(--border-color);"></div>${detailsHtml}` : ''}
                ${bioHtml}
              </article>`;

            if(resultDiv) resultDiv.innerHTML = formattedData;
          } else {
            if(resultDiv) resultDiv.innerHTML = createMessage(`Profile data not found or is incomplete for '${sanitize(username)}'.`);
          }
        })
        .catch(error => {
          if(resultDiv) resultDiv.innerHTML = createMessage(`Error: ${error.message || 'Failed to fetch profile data'}.`);
        })
        .finally(() => {
          getResultsBtn.disabled = false;
          getResultsBtn.innerText = 'Get Profile Details';
        });
    }

  </script>
</body>
</html>
