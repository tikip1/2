<!DOCTYPE html>
<html lang="en">
<head>
  <title>TikTok Account Location Finder | Full Profile Details</title>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <meta name="description" content="Find TikTok account locations by username with our free TikTok location finder. Discover user locations, profile details, stats, and more quickly using our online tool!">
  <meta name="keywords" content="TikTok location finder, tiktok profile lookup, tiktok lookup, tiktok account search, tiktok account look up, Find TikTok user location, TikTok account location, TikTok username location, Where is this TikTok user from, TikTok geolocation, TikTok user location search, Locate TikTok account by username, TikTok profile location, Find TikTok account location, Social media location finder, TikTok analytics tool, TikTok user tracker, Social media geolocation tool, TikTok data extractor, TikTok user mapping, TikTok location tracker, TikTok influencer location, Find TikTok influencers by location, TikTok marketing tool, Social media influencer finder, TikTok user search by location, Online TikTok location finder, Web tool for TikTok locations, TikTok location search engine, Browser-based TikTok locator, Free TikTok location finder, Free tool to find TikTok user location, How to find TikTok user location by username, Best tool to locate TikTok accounts, TikTok profile viewer, TikTok stats checker">
  <meta name="author" content="@_moro.__"> <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://tikip.us/"/>

  <meta property="og:title" content="TikTok Account Location Finder | Full Profile Details">
  <meta property="og:description" content="Retrieve complete TikTok user profiles, including username, bio, followers, videos, location, and more. Free tool by @_moro.__ for research and analytics."> <meta property="og:type" content="website">
  <meta property="og:url" content="https://tikip.us">
  <meta property="og:image" content="https://tikip.us/favicon.png">
  <meta property="og:site_name" content="TikTok Location Finder">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@_moro.__"> <meta name="twitter:title" content="TikTok Account Location Finder | Full Profile Details">
  <meta name="twitter:description" content="Free tool to find TikTok user locations and full profile details by username.">
  <meta name="twitter:image" content="https://tikip.us/favicon.png">
  <meta content="Global" name="distribution"/>
  <meta content="General" name="rating"/>
  <meta content="en" http-equiv="content-language"/>
  <meta content="Turkey" name="geo.country"/> <meta content="en_US" property="og:locale"/>
  <meta content="en_UK" property="og:locale:alternate"/>
  <meta content="Turkey" name="geo.placename"/> <script async src="https://www.googletagmanager.com/gtag/js?id=G-HTPQL6DM82"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HTPQL6DM82');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6346556035067219"
     crossorigin="anonymous"></script>
  <meta name="google-site-verification" content="B3Dexm1A96g9Vj5uQ3LjOOsA-RxFqSwca_G0LrOchB0" />
  <meta name="monetag" content="caa90b8bc2e2b44cb2ca5427c3072138">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="/favicon.png" type="image/png">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "TikTok Account Location Finder",
    "url": "https://tikip.us/",
    "description": "A free online tool to find TikTok account locations and full profile details by username.",
    "creator": {
      "@type": "Person",
      "name": "@_moro.__" 
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://tikip.us/?username={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "TikTok Account Location Finder",
    "applicationCategory": "SocialNetworkAnalysisTool",
    "operatingSystem": "Web",
    "browserRequirements": "Requires a modern web browser with JavaScript enabled.",
    "description": "Free web-based tool to retrieve public TikTok user profile details, including estimated location, bio, follower counts, and video statistics by username.",
    "url": "https://tikip.us/",
    "author": {
      "@type": "Person",
      "name": "@_moro.__" 
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>

  <style>
    /* CSS Root Variables and Base Styles */
    :root {
      --primary: #10B981;
      --primary-hover: #059669;
      --support-color: #EF4444;
      --support-hover: #DC2626;
      --container-bg: #000000;
      --text-color: #FFFFFF; 
      --text-secondary: #AAAAAA;
      --input-bg: #111111;
      --input-border: #222222;
      --result-bg: #000000;
      --card-bg: #080808;
      --card-header-bg: #0D0D0D;
      --patriotic-color: #FFFFFF;
      --bg-color: #000000;
      --success-color: #10B981;
      --highlight-color: #7C3AED;

      /* 3D Style Shadows - Dark Theme */
      --main-container-shadow-dark: 0 8px 20px -5px rgba(255, 255, 255, 0.03), 0 6px 8px -6px rgba(255, 255, 255, 0.03);
      --card-element-shadow-dark: 0 5px 15px -7px rgba(255, 255, 255, 0.04), 0 3px 5px -8px rgba(255, 255, 255, 0.04);
      --button-element-shadow-dark: 0 3px 5px -1px rgba(0, 0, 0, 0.4), 0 2px 3px -2px rgba(0, 0, 0, 0.4);
      --button-element-shadow-hover-dark: 0 6px 8px -2px rgba(0, 0, 0, 0.5), 0 3px 5px -3px rgba(0, 0, 0, 0.5);
      --input-element-shadow-dark: inset 0 1px 2px rgba(255, 255, 255, 0.03), 0 1px 1px rgba(255, 255, 255, 0.02);
    }

    :root[data-theme="light"] {
      --primary: #10B981;
      --primary-hover: #059669;
      --support-color: #EF4444;
      --support-hover: #DC2626;
      --container-bg: #FFFFFF; 
      --text-color: #333333; 
      --text-secondary: #666666;
      --input-bg: #F5F5F5;
      --input-border: #DDDDDD;
      --result-bg: #FFFFFF;
      --card-bg: #F9F9F9;
      --card-header-bg: #F0F0F0;
      --patriotic-color: #333333;
      --bg-color: #F5F5F5; 
      --success-color: #10B981;
      --highlight-color: #7C3AED;

      /* 3D Style Shadows - Light Theme */
      --main-container-shadow-light: 0 10px 25px -5px rgba(0, 0, 0, 0.08), 0 8px 10px -6px rgba(0, 0, 0, 0.08);
      --card-element-shadow-light: 0 6px 15px -7px rgba(0, 0, 0, 0.09), 0 4px 6px -8px rgba(0, 0, 0, 0.09);
      --button-element-shadow-light: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      --button-element-shadow-hover-light: 0 7px 10px -2px rgba(0, 0, 0, 0.15), 0 4px 6px -3px rgba(0, 0, 0, 0.15);
      --input-element-shadow-light: inset 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
    }

    /* Universal Box Sizing and Reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth; 
    }

    /* Body Styles */
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      color: var(--text-color);
      line-height: 1.6;
      -webkit-text-size-adjust: 100%; 
      text-size-adjust: 100%; 
      transition: background-color 0.3s, color 0.3s;
      margin: 0; 
      width: 100%; 
      overflow-x: hidden; 
    }

    /* Container Styles */
    .container {
      background: var(--container-bg);
      padding: 20px; 
      border-radius: 12px; 
      width: 100%; 
      max-width: 1200px; 
      margin-left: auto; 
      margin-right: auto; 
      transition: background-color 0.3s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: var(--main-container-shadow-dark);
    }
    :root[data-theme="light"] .container {
        box-shadow: var(--main-container-shadow-light);
        border: 1px solid var(--input-border); 
    }

    /* Theme Toggle Styles */
    .theme-toggle {
      position: fixed;
      top: 15px; 
      right: 15px; 
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 20px; 
      width: 40px; 
      height: 40px; 
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 1000;
      box-shadow: var(--button-element-shadow-dark);
    }
    :root[data-theme="light"] .theme-toggle {
        box-shadow: var(--button-element-shadow-light);
    }
    .theme-toggle:hover {
      transform: translateY(-2px) scale(1.05); 
      box-shadow: var(--button-element-shadow-hover-dark);
    }
    :root[data-theme="light"] .theme-toggle:hover {
        box-shadow: var(--button-element-shadow-hover-light);
    }
    .theme-toggle svg {
      width: 20px; 
      height: 20px; 
      fill: var(--text-color);
      transition: fill 0.3s;
    }

    /* Text and Heading Styles */
    .patriotic-text {
      font-size: clamp(16px, 4vw, 20px); 
      text-align: center;
      color: var(--patriotic-color);
      margin-bottom: 10px; 
      font-weight: bold;
      width: 100%;
      padding: 10px 0; 
    }
    h1 { 
      font-size: clamp(20px, 5vw, 28px); 
      font-weight: 700; 
      text-align: center;
      color: #FFFFFF; 
      margin-bottom: 10px; 
      width: 100%;
      letter-spacing: -0.5px; 
    }
    :root[data-theme="light"] h1 {
        color: #1A1A1A; 
    }
    .credit {
      font-size: clamp(10px, 3vw, 12px); 
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 20px; 
      width: 100%;
    }
    .credit a {
      color: var(--highlight-color); 
      text-decoration: none;
      font-weight: 600;
    }
    .credit a:hover {
      text-decoration: underline;
      color: var(--primary);
    }

    /* Form Element Styles */
    input[type="text"], input[type="email"], textarea {
      width: 100%;
      max-width: 600px; 
      padding: 12px 15px; 
      font-size: clamp(14px, 4vw, 16px); 
      border: 1px solid var(--input-border);
      border-radius: 10px; 
      margin-bottom: 15px; 
      background: var(--input-bg);
      color: var(--text-color);
      transition: border-color 0.3s, box-shadow 0.3s;
      -webkit-appearance: none; 
      appearance: none; 
      user-select: text;
      box-shadow: var(--input-element-shadow-dark);
    }
    :root[data-theme="light"] input[type="text"], 
    :root[data-theme="light"] input[type="email"], 
    :root[data-theme="light"] textarea {
        box-shadow: var(--input-element-shadow-light);
    }
    input[type="text"]:focus, 
    input[type="email"]:focus, 
    textarea:focus {
      outline: none;
      border-color: var(--primary); 
       box-shadow: var(--input-element-shadow-dark), 0 0 0 3px color-mix(in srgb, var(--primary) 30%, transparent); 
    }
    :root[data-theme="light"] input[type="text"]:focus,
    :root[data-theme="light"] input[type="email"]:focus,
    :root[data-theme="light"] textarea:focus {
       box-shadow: var(--input-element-shadow-light), 0 0 0 3px color-mix(in srgb, var(--primary) 30%, transparent);
    }
    input::placeholder, textarea::placeholder {
      color: var(--text-secondary);
      opacity: 0.7;
    }

    /* Button Styles */
    button {
      width: 100%;
      max-width: 600px; 
      padding: 12px 15px; 
      font-size: clamp(14px, 4vw, 16px); 
      border: none;
      border-radius: 10px; 
      color: white;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 10px; 
      transition: all 0.2s ease-out; 
      -webkit-tap-highlight-color: transparent; 
      text-shadow: 0 1px 1px rgba(0,0,0,0.2); 
      box-shadow: var(--button-element-shadow-dark);
    }
    :root[data-theme="light"] button {
        box-shadow: var(--button-element-shadow-light);
    }
    button:active {
        transform: translateY(1px) scale(0.99); 
        box-shadow: 0 1px 2px -1px var(--button-element-shadow-dark);
    }
    :root[data-theme="light"] button:active {
        box-shadow: 0 1px 2px -1px var(--button-element-shadow-light);
    }
    #getResultsBtn {
      background: linear-gradient(145deg, var(--primary), var(--primary-hover)); 
    }
    #getResultsBtn:hover, #getResultsBtn:focus {
      background: linear-gradient(145deg, var(--primary-hover), var(--primary)); 
      transform: translateY(-2px); 
      box-shadow: var(--button-element-shadow-hover-dark);
    }
    :root[data-theme="light"] #getResultsBtn:hover,
    :root[data-theme="light"] #getResultsBtn:focus {
        box-shadow: var(--button-element-shadow-hover-light);
    }
    #supportBtn {
      background: linear-gradient(145deg, var(--support-color), var(--support-hover)); 
      margin-bottom: 0; 
    }
    #supportBtn:hover, #supportBtn:focus {
      background: linear-gradient(145deg, var(--support-hover), var(--support-color)); 
      transform: translateY(-2px); 
      box-shadow: var(--button-element-shadow-hover-dark);
    }
    :root[data-theme="light"] #supportBtn:hover,
    :root[data-theme="light"] #supportBtn:focus {
        box-shadow: var(--button-element-shadow-hover-light);
    }

    /* Result Display Styles */
    #result {
      background: transparent; 
      padding: 0; 
      margin-top: 25px; 
      border: none; 
      min-height: 50px; 
      width: 100%;
      max-width: 600px; 
    }
    .profile-card {
      background: var(--card-bg);
      border-radius: 12px; 
      border: 1px solid var(--input-border);
      overflow: hidden;
      transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
      width: 100%;
      max-width: 600px; 
      box-shadow: var(--card-element-shadow-dark);
    }
    :root[data-theme="light"] .profile-card {
        box-shadow: var(--card-element-shadow-light);
    }
    .profile-card-header {
      display: flex;
      align-items: center;
      padding: 20px; 
      background: var(--card-header-bg);
      border-bottom: 1px solid var(--input-border);
      transition: background-color 0.3s, border-color 0.3s;
    }
    .profile-photo-enhanced {
      width: 70px; 
      height: 70px; 
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px; 
      border: 3px solid var(--primary);
      flex-shrink: 0;
      background-color: var(--input-bg); 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
      max-width: 100%; /* MODIFIED: Ensure image is responsive */
      height: auto; /* MODIFIED: Maintain aspect ratio */
    }
    .profile-photo-placeholder {
      width: 70px; 
      height: 70px; 
      border-radius: 50%;
      margin-right: 20px; 
      background-color: var(--input-bg);
      border: 3px solid var(--input-border);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-secondary);
      flex-shrink: 0;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .profile-photo-placeholder svg {
      width: 36px; 
      height: 36px; 
      fill: var(--text-secondary);
    }
    .profile-identity {
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-width: 0; 
    }
    .profile-nickname {
      font-size: clamp(18px, 4.5vw, 22px); 
      font-weight: 600;
      color: var(--text-color);
      margin: 0 0 4px 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .profile-username-display {
      font-size: clamp(13px, 3.5vw, 15px); 
      color: var(--text-secondary);
      margin: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .profile-card-body {
      padding: 10px 20px 20px 20px; 
    }
    .profile-info-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start; 
      padding: 10px 0; 
      border-bottom: 1px solid var(--input-bg);
      font-size: clamp(13px, 3.5vw, 14px); 
      gap: 10px; 
    }
    .profile-info-row:last-child {
      border-bottom: none;
    }
    .info-label {
      font-weight: 600;
      color: var(--text-secondary);
      margin-right: 10px; 
      flex-shrink: 0;
      text-transform: capitalize; 
    }
    .info-value {
      color: var(--text-color);
      text-align: right;
      word-break: break-word; 
      flex-grow: 1;
      min-width: 0; 
    }
    .bio-row { 
      flex-direction: column;
      align-items: flex-start;
    }
    .bio-row .info-label {
      margin-bottom: 8px;
    }
    .bio-row .info-value.bio-text {
      text-align: left;
      width: 100%;
      line-height: 1.5;
      white-space: pre-wrap; 
      color: var(--text-secondary);
      font-size: clamp(12px, 3.2vw, 13px); 
    }
    .profile-card-footer {
      padding: 15px 20px; 
      background: var(--card-header-bg);
      border-top: 1px solid var(--input-border);
      text-align: center;
      transition: background-color 0.3s, border-color 0.3s;
    }

    /* Message and Loading Styles */
    .message {
      padding: 10px 15px; 
      border-radius: 8px; 
      font-weight: 500;
      margin: 0;
      display: inline-block;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    :root[data-theme="dark"] .message {
        box-shadow: 0 1px 3px rgba(255,255,255,0.05);
    }
    .success-message {
      color: var(--success-color);
      background-color: color-mix(in srgb, var(--success-color) 15%, transparent); 
      border: 1px solid color-mix(in srgb, var(--success-color) 30%, transparent);
    }
    .error-message {
      color: var(--support-color);
      background-color: color-mix(in srgb, var(--support-color) 15%, transparent); 
      border: 1px solid color-mix(in srgb, var(--support-color) 30%, transparent);
    }
    .loading-spinner-container {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px; 
      color: var(--text-secondary);
      text-align: center;
      width: 100%;
    }
    .loading-spinner {
      display: inline-block;
      width: 24px; 
      height: 24px; 
      border: 3px solid color-mix(in srgb, var(--text-color) 20%, transparent); 
      border-radius: 50%;
      border-top-color: var(--text-color);
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px; 
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Main Content and Section Styles */
    main {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0 15px; 
    }
    .about-section, .page-content > .about-section, .footer { 
      margin-top: 25px; 
      padding: 20px; 
      background: var(--card-bg);
      border-radius: 10px; 
      font-size: clamp(13px, 3.5vw, 14px); 
      line-height: 1.7; 
      border: 1px solid var(--input-border);
      transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
      width: 100%;
      max-width: 600px; 
      box-shadow: var(--card-element-shadow-dark);
    }
    :root[data-theme="light"] .about-section,
    :root[data-theme="light"] .page-content > .about-section,
    :root[data-theme="light"] .footer {
        box-shadow: var(--card-element-shadow-light);
    }
    .page-content { 
        display: none; 
        width: 100%;
        max-width: 600px; 
        margin-top: 25px;
    }
    .page-content.active {
        display: block; 
    }
    .page-content h1 { 
        font-size: clamp(20px, 5vw, 24px); 
        color: var(--highlight-color);
        margin-bottom: 15px;
        text-align: left; 
    }
    .about-section h2 { 
      color: var(--highlight-color);
      font-size: clamp(16px, 4vw, 18px); 
      margin-bottom: 10px; 
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .about-section p {
      margin-bottom: 12px; 
      color: var(--text-secondary);
    }
    .about-section p:last-child {
      margin-bottom: 0;
    }
    .dm-link {
      color: var(--highlight-color);
      text-decoration: none;
      font-weight: 600;
    }
    .dm-link:hover {
      text-decoration: underline;
      color: var(--primary);
    }

    /* Footer Styles */
    .footer {
        margin-bottom: 20px; 
    }
    .footer-nav {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px 20px; 
    }
    .footer-nav a {
      color: var(--highlight-color);
      text-decoration: none;
      font-size: clamp(12px, 3.2vw, 13px); 
      font-weight: 600;
      transition: color 0.3s, transform 0.2s, background-color 0.3s; /* Added background-color transition */
      padding: 5px 8px; 
      border-radius: 6px; 
    }
     .footer-nav a:hover {
      text-decoration: none; 
      background-color: color-mix(in srgb, var(--primary) 15%, transparent);
      color: var(--primary);
      transform: translateY(-1px); 
    }

    /* Contact Form Specific Styles */
    .contact-form {
      display: flex;
      flex-direction: column;
      gap: 15px; 
      margin-top: 15px; 
      width: 100%;
      max-width: 600px; 
    }
    .contact-form textarea {
      resize: vertical;
      min-height: 120px; 
    }
    .contact-form button { 
      background: linear-gradient(145deg, var(--primary), var(--primary-hover)); 
    }
    .contact-form button:hover,
    .contact-form button:focus { 
      background: linear-gradient(145deg, var(--primary-hover), var(--primary));
      transform: translateY(-2px);
      box-shadow: var(--button-element-shadow-hover-dark);
    }
     :root[data-theme="light"] .contact-form button:hover,
     :root[data-theme="light"] .contact-form button:focus {
        box-shadow: var(--button-element-shadow-hover-light);
    }
    .back-btn { 
      background: linear-gradient(145deg, var(--text-secondary), color-mix(in srgb, var(--text-secondary) 80%, black)); 
      margin-top: 20px; 
    }
    :root[data-theme="light"] .back-btn {
      background: linear-gradient(145deg, #e0e0e0, #cccccc);
      color: #333;
    }
    .back-btn:hover,
    .back-btn:focus { 
      background: linear-gradient(145deg, color-mix(in srgb, var(--text-secondary) 80%, black), var(--text-secondary));
      transform: translateY(-2px);
      box-shadow: var(--button-element-shadow-hover-dark);
    }
    :root[data-theme="light"] .back-btn:hover,
    :root[data-theme="light"] .back-btn:focus {
        background: linear-gradient(145deg, #cccccc, #e0e0e0);
        box-shadow: var(--button-element-shadow-hover-light);
    }

    /* Ad Banner Styles */
    #ad-banner {
      width: 100%;
      max-width: 600px; 
      margin: 20px auto; 
      text-align: center;
      padding: 10px; 
      background: var(--card-bg);
      border: 1px solid var(--input-border);
      border-radius: 10px; 
      transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
      box-shadow: var(--card-element-shadow-dark);
    }
    :root[data-theme="light"] #ad-banner {
        box-shadow: var(--card-element-shadow-light);
    }

    /* ----- Responsive Media Queries ----- */

    /* For tablets and smaller devices (<= 768px) */
    @media (max-width: 768px) {
        .container {
            padding: 15px;
        }
        main {
            padding: 0 10px; 
        }
        h1 {
             font-size: clamp(20px, 6vw, 24px);
        }
        .page-content h1 {
            font-size: clamp(18px, 5vw, 22px);
        }
        input[type="text"], input[type="email"], textarea, button {
            padding: 10px 12px;
            font-size: clamp(14px, 3.8vw, 15px);
        }
        .profile-card-header, .profile-card-body, .profile-card-footer {
            padding: 15px;
        }
        .profile-photo-enhanced, .profile-photo-placeholder {
            width: 60px;
            height: 60px;
            margin-right: 15px;
        }
         .profile-photo-placeholder svg {
            width: 30px;
            height: 30px;
        }
        .about-section, .page-content > .about-section, .footer {
            padding: 15px;
        }
    }

    /* For smaller tablets and large phones (<= 600px) */
    @media (max-width: 600px) { 
      .container { 
          border-radius: 8px; 
      }
      /* Max-width 100% for these elements ensures they don't overflow their parent on small screens */
      .about-section, .page-content, .page-content > .about-section, .footer, #result, .profile-card, #ad-banner { 
          max-width: 100%; 
          border-radius: 8px; 
      }
      .theme-toggle { 
          top: 10px; 
          right: 10px; 
          width: 36px; 
          height: 36px; 
      } 
      .footer-nav { 
          gap: 8px 15px; 
      }
      #ad-banner { 
          padding: 8px;
      } 
    }

    /* For smaller mobile devices (<= 480px) */
    @media (max-width: 480px) { 
        .container {
            padding: 10px;
        }
        main {
            padding: 0 5px;
        }
        h1 {
            font-size: clamp(18px, 6.5vw, 22px);
        }
        .page-content h1 {
            font-size: clamp(17px, 5.5vw, 20px);
        }
        .patriotic-text { font-size: 14px; }
        .credit { font-size: 10px; }
        input[type="text"], input[type="email"], textarea, button {
            padding: 9px 10px;
            font-size: clamp(13px, 3.5vw, 14px);
        }
        .profile-card-header, .profile-card-body, .profile-card-footer {
            padding: 12px;
        }
        .profile-photo-enhanced, .profile-photo-placeholder {
            width: 50px;
            height: 50px;
        }
        .profile-photo-placeholder svg {
            width: 24px;
            height: 24px;
        }
        .info-label { margin-right: 8px; }
        .theme-toggle { 
            top: 8px; 
            right: 8px; 
            width: 32px; 
            height: 32px; 
        }
        .theme-toggle svg { 
            width: 16px; 
            height: 16px; 
        }
        .footer-nav { 
            flex-direction: column; 
            align-items: center; 
            gap: 8px; 
        }
        .about-section, .page-content > .about-section, .footer {
            padding: 12px;
        }
    }

    /* For larger screens like desktops (>= 1024px) */
    @media (min-width: 1024px) { 
      /* Constrain the width of main content elements on very wide screens */
      input, button, .about-section, .page-content, .page-content > .about-section, .footer, #result, .profile-card, #ad-banner { 
        max-width: 700px; 
      }
    }
    
    /* iOS specific font size fix for inputs in landscape mode to prevent auto-zoom */
    @media screen and (max-width: 767px) and (orientation: landscape) {
      input[type="text"], input[type="email"], textarea, select { 
        font-size: 16px !important; 
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Toggle theme">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1-8.313-12.454z"/>
      </svg>
    </button>
    
    <main>
        <div class="page-content active" id="main-page">
          <div class="patriotic-text">🇲🇦👑 الله الوطـــن الملك 🇲🇦👑</div>
          <h1>TikTok Account Location Finder</h1>
          <div class="credit">Created by <a href="https://www.tiktok.com/@_moro.__" target="_blank" rel="noopener noreferrer">@_moro.__</a></div>
          
          <section aria-labelledby="search-tool-heading">
            <h2 id="search-tool-heading" class="sr-only">TikTok Profile Search Tool</h2>
            <input type="text" id="username" placeholder="Enter TikTok username (without @)" required aria-label="TikTok Username Input" autocapitalize="none" autocorrect="off">
            <button id="getResultsBtn" aria-label="Search TikTok profile">Get Profile Details</button>
            <button id="supportBtn" aria-label="Support the creator" title="Support the creator">Support Our Work ❤</button>
          </section>
          <div id="result" aria-live="polite" role="region"></div>
          <article class="about-section" aria-labelledby="about-tool-heading">
            <h2 id="about-tool-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.064.293.006.399.287.47l.45.082.082.38-.229.287a.235.235 0 0 1-.399-.043l-.738-3.468a.235.235 0 0 1 .043-.399l.287-.229.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.064.293.006.399.287.47l.45.082.082.38-.229.287a.235.235 0 0 1-.399-.043l-.738-3.468a.235.235 0 0 1 .043-.399zM8 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>
                About This Tool
            </h2>
            <p>Retrieve complete TikTok user profiles, including username, bio, followers, videos, location, and more. A free tool for researchers and social media enthusiasts.</p>
            <p><strong>Features:</strong> Full profile lookup, country flags, bio display, follower and video stats, responsive design, dark/light mode.</p>
          </article>
          
          <article class="about-section" aria-labelledby="faq-heading">
            <h2 id="faq-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.11.248-.247V5.31c0-.084.048-.148.122-.182.074-.034.152-.024.214.035l.87.949a1.112 1.112 0 0 0 1.57-.02l.024-.026.87-.95a.242.242 0 0 0 .023-.33.237.237 0 0 0-.33-.023l-.87.95-.025.026a.872.872 0 0 1-1.22-.016L5.49 5.006a.237.237 0 0 0-.33.048.242.242 0 0 0 .048.33l.024.025.87.95a.242.242 0 0 0 .354.023l.016-.016.21-.23a.237.237 0 0 0 .04-.139V5.31c0-.138-.11-.247-.247-.247H5.496a.237.237 0 0 0-.241.247zm0 3.203a.237.237 0 0 0 .241.247h.825c.138 0 .248-.11.248-.247V8.41c0-.084.048-.148.122-.182.074-.034.152-.024.214.035l.87.949a1.112 1.112 0 0 0 1.57-.02l.024-.026.87-.95a.242.242 0 0 0 .023-.33.237.237 0 0 0-.33-.023l-.87.95-.025.026a.872.872 0 0 1-1.22-.016L5.49 7.996a.237.237 0 0 0-.33.048.242.242 0 0 0 .048.33l.024.025.87.95a.242.242 0 0 0 .354.023l.016-.016.21-.23a.237.237 0 0 0 .04-.139V8.41c0-.138-.11-.247-.247-.247H5.496a.237.237 0 0 0-.241.247z"/></svg>
                FAQ
            </h2>
            <p><strong>What does this tool do?</strong> Fetches all public TikTok profile details, such as username, bio, followers, videos, and estimated country.</p>
            <p><strong>Is it free?</strong> Yes, completely free with no hidden fees.</p>
            <p><strong>How accurate is the data?</strong> Based on public info; location and stats may vary in accuracy.</p>
          </article>
          
          <article class="about-section" aria-labelledby="about-creator-heading">
            <h2 id="about-creator-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                About the Creator
            </h2>
            <p>I'm Moor, a Graphic Designer & Web Developer with 4+ years of experience, passionate about building tools like this.</p>
            <p>Reach out on <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">TikTok</a> or support my work!</p> </article>
          
          <article class="about-section" aria-labelledby="get-involved-heading">
            <h2 id="get-involved-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M4 2.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1V11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V4h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5H4zM3.5 1a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1v1a.5.5 0 0 1-1 0V2H4v1a.5.5 0 0 1-1 0V2h-.5a.5.5 0 0 1-.5-.5v-1zM9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/><path d="M1.822 6.32L3.5 5.28V2.51L1.822 3.882A1.5 1.5 0 0 0 1 5.035v5.93a1.5 1.5 0 0 0 .822 1.386L3.5 13.72V11.18l-1.678-.933A.5.5 0 0 1 1.5 9.78v-3.5a.5.5 0 0 1 .322-.46zM12.5 11.18V13.72l1.678-1.335A1.5 1.5 0 0 0 15 10.965V5.035a1.5 1.5 0 0 0-.822-1.386L12.5 2.51v2.77l1.678 1.04A.5.5 0 0 1 14.5 6.28v3.5a.5.5 0 0 1-.322.46L12.5 11.18z"/></svg>
                Get Involved
            </h2>
            <p>Enjoy this tool? Share it or support its development to keep it free!</p>
            <p><a href="https://ko-fi.com/moroccan" class="dm-link" target="_blank" rel="noopener noreferrer">Support on Ko-fi</a> | <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">Follow on TikTok</a></p> </article>
          
          <article class="about-section" aria-labelledby="disclaimer-heading">
            <h2 id="disclaimer-heading">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                Disclaimer
            </h2>
            <p>For educational use only. Respect user privacy and use responsibly. Data is sourced publicly and may not be 100% accurate.</p>
          </article>
        </div>

        <section class="page-content" id="contact-page" aria-labelledby="contact-page-heading">
          <h1 id="contact-page-heading">Contact Us</h1>
          <article class="about-section">
            <p>Have questions or feedback? Reach out to us using the form below or contact us directly via <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">TikTok</a>.</p> <form class="contact-form" aria-labelledby="contact-page-heading" id="main-contact-form">
              <label for="contact-name" class="sr-only">Your Name</label>
              <input type="text" id="contact-name" name="contact-name" placeholder="Your Name" required aria-label="Your Name">
              <label for="contact-email" class="sr-only">Your Email</label>
              <input type="email" id="contact-email" name="contact-email" placeholder="Your Email" required aria-label="Your Email">
              <label for="contact-message" class="sr-only">Your Message</label>
              <textarea id="contact-message" name="contact-message" placeholder="Your Message" required aria-label="Your Message"></textarea>
              <button type="submit" id="contact-submit">Send Message</button>
            </form>
          </article>
          <button class="back-btn" onclick="showPage('main-page')">Back to Home</button>
        </section>

        <section class="page-content" id="about-page" aria-labelledby="about-us-page-heading">
          <h1 id="about-us-page-heading">About Us</h1>
          <article class="about-section">
            <p>Welcome to the TikTok Account Location Finder, a free tool created by <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">@_moro.__</a>.</p> <p>Our mission is to provide a user-friendly platform for researchers, marketers, and social media enthusiasts to access public TikTok profile data. This tool is designed with simplicity, accessibility, and responsiveness in mind, ensuring it works seamlessly across all devices.</p>
            <p>Built by Moor, a passionate Graphic Designer and Web Developer with over 4 years of experience, this project reflects a commitment to creating innovative tools for the community. Follow us on <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">TikTok</a> for updates and more!</p> </article>
          <button class="back-btn" onclick="showPage('main-page')">Back to Home</button>
        </section>

        <section class="page-content" id="privacy-page" aria-labelledby="privacy-policy-page-heading">
          <h1 id="privacy-policy-page-heading">Privacy Policy</h1>
          <article class="about-section">
            <h2>1. Introduction</h2>
            <p>We value your privacy and are committed to protecting your personal information. This Privacy Policy explains how we collect, use, and safeguard your data when you use the TikTok Account Location Finder.</p>
            
            <h2>2. Information We Collect</h2>
            <p>We do not collect personal information unless you voluntarily provide it (e.g., via the contact form). The tool fetches publicly available TikTok profile data, which may include usernames, bios, follower counts, and other public metrics.</p>
            
            <h2>3. How We Use Your Information</h2>
            <p>Any information provided through the contact form (e.g., name, email, message) is used solely to respond to your inquiries. Public TikTok data is retrieved and displayed for informational purposes only.</p>
            
            <h2>4. Data Sharing</h2>
            <p>We do not sell, trade, or share your personal information with third parties, except as required by law. Public TikTok data is sourced via a third-party API and is not stored by us.</p>
            
            <h2>5. Cookies and Tracking</h2>
            <p>This site uses local storage to save theme preferences. We use Google Analytics for anonymous usage statistics to improve the tool. No other cookies or third-party trackers are used for collecting personal data.</p>
            
            <h2>6. Contact Us</h2>
            <p>If you have any questions about this Privacy Policy, please contact us via <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">TikTok</a> or the contact form.</p> </article>
          <button class="back-btn" onclick="showPage('main-page')">Back to Home</button>
        </section>

        <section class="page-content" id="terms-page" aria-labelledby="terms-of-service-page-heading">
          <h1 id="terms-of-service-page-heading">Terms of Service</h1>
          <article class="about-section">
            <h2>1. Acceptance of Terms</h2>
            <p>By using the TikTok Account Location Finder ("Tool"), you agree to these Terms of Service. If you do not agree, please do not use the Tool.</p>
            
            <h2>2. Use of the Tool</h2>
            <p>This Tool is for educational and research purposes only. You agree to use it responsibly and respect the privacy of others. Do not use the Tool for illegal activities, to harass individuals, or to violate TikTok's terms of service.</p>
            
            <h2>3. Data Accuracy</h2>
            <p>The Tool fetches publicly available TikTok data via a third-party API. We do not guarantee the accuracy, completeness, or timeliness of the data provided. Information may be estimated or outdated.</p>
            
            <h2>4. Intellectual Property</h2>
            <p>All content, design, and code on this site are the property of the creator (@_moro.__). Unauthorized copying or distribution is prohibited.</p> <h2>5. Limitation of Liability</h2>
            <p>We are not liable for any damages arising from the use or inability to use this Tool. Use it at your own risk. We are not affiliated with TikTok.</p>
            
            <h2>6. Changes to Terms</h2>
            <p>We may update these Terms of Service at any time. Continued use of the Tool constitutes acceptance of the updated terms.</p>
            
            <h2>7. Contact Us</h2>
            <p>If you have any questions about these Terms, please contact us via <a href="https://www.tiktok.com/@_moro.__" class="dm-link" target="_blank" rel="noopener noreferrer">TikTok</a> or the contact form.</p> </article>
          <button class="back-btn" onclick="showPage('main-page')">Back to Home</button>
        </section>
    </main>
    
    <footer class="footer">
      <nav class="footer-nav" aria-label="Footer navigation">
        <a href="#main-page" onclick="showPage('main-page'); return false;">Home</a>
        <a href="#about-page" onclick="showPage('about-page'); return false;">About Us</a>
        <a href="#contact-page" onclick="showPage('contact-page'); return false;">Contact Us</a>
        <a href="#privacy-page" onclick="showPage('privacy-page'); return false;">Privacy Policy</a>
        <a href="#terms-page" onclick="showPage('terms-page'); return false;">Terms of Service</a>
      </nav>
    </footer>

  </div>
  <script>
    // ===== DOMAIN RESTRICTION ===== //
    if (window.location.hostname !== 'tikip.us' && 
        window.location.hostname !== 'localhost' && 
        !window.location.hostname.endsWith('.usercontent.goog')) { 
      document.body.innerHTML = '<div style="text-align:center; padding:50px; font-family: Inter, sans-serif;"><h1>Unauthorized Domain</h1><p>This application is only authorized to run on tikip.us.</p></div>';
      console.error('Unauthorized domain. Expected tikip.us, localhost, or *.usercontent.goog, got: ' + window.location.hostname);
      throw new Error('Unauthorized domain. Application execution halted.');
    }

    // Base title for the website
    const baseTitle = "TikTok Account Location Finder | Full Profile Details";

    // ===== THEME TOGGLE FUNCTIONALITY ===== //
    const themeToggle = document.getElementById('themeToggle');
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');

    function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        updateThemeIcon(theme);
    }

    const savedTheme = localStorage.getItem('theme');
    const initialTheme = savedTheme ? savedTheme : (prefersDarkScheme.matches ? 'dark' : 'light');
    applyTheme(initialTheme);

    if (themeToggle) {
        themeToggle.addEventListener('click', function() {
          let currentTheme = document.documentElement.getAttribute('data-theme');
          let newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          applyTheme(newTheme);
        });
    }

    function updateThemeIcon(theme) {
      if (!themeToggle) return;
      const icon = themeToggle.querySelector('svg');
      if (!icon) return;
      if (theme === 'dark') {
        icon.innerHTML = '<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1-8.313-12.454z"/>';
        themeToggle.setAttribute('title', 'Switch to Light Mode');
      } else {
        icon.innerHTML = '<path d="M12 18a6 6 0 1 1 0-12 6 6 0 1 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 1 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/>';
        themeToggle.setAttribute('title', 'Switch to Dark Mode');
      }
    }

    // ===== PAGE NAVIGATION ===== //
    function showPage(pageId) {
      document.querySelectorAll('.page-content').forEach(page => {
        page.classList.remove('active');
      });
      const targetPage = document.getElementById(pageId);
      if (targetPage) {
        targetPage.classList.add('active');
        const pageTitleElement = targetPage.querySelector('h1');
        if (pageTitleElement && pageId !== 'main-page') {
            document.title = pageTitleElement.textContent.trim() + " | " + baseTitle.split('|')[0].trim();
        } else {
            document.title = baseTitle;
        }
        targetPage.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else {
        console.warn(`Page with ID "${pageId}" not found. Defaulting to main page.`);
        const mainPage = document.getElementById('main-page');
        if(mainPage) mainPage.classList.add('active');
        document.title = baseTitle;
        if(mainPage) mainPage.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }
    window.addEventListener('hashchange', () => {
        const pageId = window.location.hash.substring(1);
        if (pageId) {
            showPage(pageId);
        } else {
            showPage('main-page');
        }
    });
    if (window.location.hash) {
        showPage(window.location.hash.substring(1));
    } else {
        showPage('main-page');
    }

    // ===== CONTACT FORM SUBMISSION ===== //
    const contactForm = document.getElementById('main-contact-form'); 
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) { 
          e.preventDefault();
          const nameInput = document.getElementById('contact-name');
          const emailInput = document.getElementById('contact-email');
          const messageInput = document.getElementById('contact-message');
          const resultContainer = this.closest('.page-content').querySelector('.about-section'); 
          
          const name = nameInput ? nameInput.value.trim() : '';
          const email = emailInput ? emailInput.value.trim() : '';
          const message = messageInput ? messageInput.value.trim() : '';
          
          let feedbackMessage = resultContainer.querySelector('.form-feedback');
          if (!feedbackMessage) {
              feedbackMessage = document.createElement('div');
              feedbackMessage.className = 'form-feedback';
              this.parentNode.insertBefore(feedbackMessage, this.nextSibling);
          }

          if (name && email && message && email.includes('@')) {
            feedbackMessage.innerHTML = '<div class="message success-message">Thank you for your message! We will get back to you soon.</div>';
            if(nameInput) nameInput.value = '';
            if(emailInput) emailInput.value = '';
            if(messageInput) messageInput.value = '';
          } else {
            feedbackMessage.innerHTML = '<div class="message error-message">Please fill in all fields correctly.</div>';
          }
          setTimeout(() => { if(feedbackMessage) feedbackMessage.innerHTML = ''; }, 5000);
        });
    }

    // ===== COUNTRY FLAG MAPPING ===== //
    function getCountryFlag(country) {
      const flagMap = {
        'AD': '🇦🇩', 'Andorra': '🇦🇩', 'AE': '🇦🇪', 'United Arab Emirates': '🇦🇪', 'UAE': '🇦🇪',
        'AF': '🇦🇫', 'Afghanistan': '🇦🇫', 'AG': '🇦🇬', 'Antigua and Barbuda': '🇦🇬',
        'AI': '🇦🇮', 'Anguilla': '🇦🇮', 'AL': '🇦🇱', 'Albania': '🇦🇱', 'AM': '🇦🇲', 'Armenia': '🇦🇲',
        'AO': '🇦🇴', 'Angola': '🇦🇴', 'AQ': '🇦🇶', 'Antarctica': '🇦🇶', 'AR': '🇦🇷', 'Argentina': '🇦🇷',
        'AS': '🇦🇸', 'American Samoa': '🇦🇸', 'AT': '🇦🇹', 'Austria': '🇦🇹',
        'AU': '🇦🇺', 'Australia': '🇦🇺', 'AW': '🇦🇼', 'Aruba': '🇦🇼', 'AX': '🇦🇽', 'Åland Islands': '🇦🇽',
        'AZ': '🇦🇿', 'Azerbaijan': '🇦🇿', 'BA': '🇧🇦', 'Bosnia and Herzegovina': '🇧🇦',
        'BB': '🇧🇧', 'Barbados': '🇧🇧', 'BD': '🇧🇩', 'Bangladesh': '🇧🇩', 'BE': '🇧🇪', 'Belgium': '🇧🇪',
        'BF': '🇧🇫', 'Burkina Faso': '🇧🇫', 'BG': '🇧🇬', 'Bulgaria': '🇧🇬', 'BH': '🇧🇭', 'Bahrain': '🇧🇭',
        'BI': '🇧🇮', 'Burundi': '🇧🇮', 'BJ': '🇧🇯', 'Benin': '🇧🇯', 'BL': '🇧🇱', 'Saint Barthélemy': '🇧🇱',
        'BM': '🇧🇲', 'Bermuda': '🇧🇲', 'BN': '🇧🇳', 'Brunei Darussalam': '🇧🇳', 'Brunei': '🇧🇳',
        'BO': '🇧🇴', 'Bolivia': '🇧🇴', 'BQ': '🇧🇶', 'Bonaire, Sint Eustatius and Saba': '🇧🇶', 'Caribbean Netherlands': '🇧🇶',
        'BR': '🇧🇷', 'Brazil': '🇧🇷', 'BS': '🇧🇸', 'Bahamas': '🇧🇸', 'BT': '🇧🇹', 'Bhutan': '🇧🇹',
        'BV': '🇧🇻', 'Bouvet Island': '🇧🇻', 'BW': '🇧🇼', 'Botswana': '🇧🇼', 'BY': '🇧🇾', 'Belarus': '🇧🇾',
        'BZ': '🇧🇿', 'Belize': '🇧🇿', 'CA': '🇨🇦', 'Canada': '🇨🇦',
        'CC': '🇨🇨', 'Cocos (Keeling) Islands': '🇨🇨',
        'CD': '🇨🇩', 'Congo, Democratic Republic of the': '🇨🇩', 'DR Congo': '🇨🇩',
        'CF': '🇨🇫', 'Central African Republic': '🇨🇫', 'CAR': '🇨🇫',
        'CG': '🇨🇬', 'Congo, Republic of the': '🇨🇬', 'Congo-Brazzaville': '🇨🇬',
        'CH': '🇨🇭', 'Switzerland': '🇨🇭', 'CI': '🇨🇮', "Côte d'Ivoire": '🇨🇮', "Ivory Coast": '🇨🇮',
        'CK': '🇨🇰', 'Cook Islands': '🇨🇰', 'CL': '🇨🇱', 'Chile': '🇨🇱', 'CM': '🇨🇲', 'Cameroon': '🇨🇲',
        'CN': '🇨🇳', 'China': '🇨🇳', 'CO': '🇨🇴', 'Colombia': '🇨🇴', 'CR': '🇨🇷', 'Costa Rica': '🇨🇷',
        'CU': '🇨🇺', 'Cuba': '🇨🇺', 'CV': '🇨🇻', 'Cape Verde': '🇨🇻', 'Cabo Verde': '🇨🇻',
        'CW': '🇨🇼', 'Curaçao': '🇨🇼', 'CX': '🇨🇽', 'Christmas Island': '🇨🇽',
        'CY': '🇨🇾', 'Cyprus': '🇨🇾', 'CZ': '🇨🇿', 'Czech Republic': '🇨🇿', 'Czechia': '🇨🇿',
        'DE': '🇩🇪', 'Germany': '🇩🇪', 'DJ': '🇩🇯', 'Djibouti': '🇩🇯', 'DK': '🇩🇰', 'Denmark': '🇩🇰',
        'DM': '🇩🇲', 'Dominica': '🇩🇲', 'DO': '🇩🇴', 'Dominican Republic': '🇩🇴',
        'DZ': '🇩🇿', 'Algeria': '🇩🇿', 'EC': '🇪🇨', 'Ecuador': '🇪🇨', 'EE': '🇪🇪', 'Estonia': '🇪🇪',
        'EG': '🇪🇬', 'Egypt': '🇪🇬', 'EH': '🇪🇭', 'Western Sahara': '🇪🇭', 'ER': '🇪🇷', 'Eritrea': '🇪🇷',
        'ES': '🇪🇸', 'Spain': '🇪🇸', 'ET': '🇪🇹', 'Ethiopia': '🇪🇹', 'FI': '🇫🇮', 'Finland': '🇫🇮',
        'FJ': '🇫🇯', 'Fiji': '🇫🇯', 'FK': '🇫🇰', 'Falkland Islands (Malvinas)': '🇫🇰',
        'FM': '🇫🇲', 'Micronesia, Federated States of': '🇫🇲', 'Micronesia': '🇫🇲',
        'FO': '🇫🇴', 'Faroe Islands': '🇫🇴', 'FR': '🇫🇷', 'France': '🇫🇷', 'GA': '🇬🇦', 'Gabon': '🇬🇦',
        'GB': '🇬🇧', 'United Kingdom': '🇬🇧', 'UK': '🇬🇧', 'Great Britain': '🇬🇧',
        'GD': '🇬🇩', 'Grenada': '🇬🇩', 'GE': '🇬🇪', 'Georgia': '🇬🇪', 'GF': '🇬🇫', 'French Guiana': '🇬🇫',
        'GG': '🇬🇬', 'Guernsey': '🇬🇬', 'GH': '🇬🇭', 'Ghana': '🇬🇭', 'GI': '🇬🇮', 'Gibraltar': '🇬🇮',
        'GL': '🇬🇱', 'Greenland': '🇬🇱', 'GM': '🇬🇲', 'Gambia': '🇬🇲', 'GN': '🇬🇳', 'Guinea': '🇬🇳',
        'GP': '🇬🇵', 'Guadeloupe': '🇬🇵', 'GQ': '🇬🇶', 'Equatorial Guinea': '🇬🇶',
        'GR': '🇬🇷', 'Greece': '🇬🇷', 'GS': '🇬🇸', 'South Georgia and the South Sandwich Islands': '🇬🇸',
        'GT': '🇬🇹', 'Guatemala': '🇬🇹', 'GU': '🇬🇺', 'Guam': '🇬🇺', 'GW': '🇬🇼', 'Guinea-Bissau': '🇬🇼',
        'GY': '🇬🇾', 'Guyana': '🇬🇾', 'HK': '🇭🇰', 'Hong Kong': '🇭🇰',
        'HM': '🇭🇲', 'Heard Island and McDonald Islands': '🇭🇲',
        'HN': '🇭🇳', 'Honduras': '🇭🇳', 'HR': '🇭🇷', 'Croatia': '🇭🇷', 'HT': '🇭🇹', 'Haiti': '🇭🇹',
        'HU': '🇭🇺', 'Hungary': '🇭🇺', 'ID': '🇮🇩', 'Indonesia': '🇮🇩', 'IE': '🇮🇪', 'Ireland': '🇮🇪',
        'IL': '🇮🇱', 'Israel': '🇮🇱', 'IM': '🇮🇲', 'Isle of Man': '🇮🇲', 'IN': '🇮🇳', 'India': '🇮🇳',
        'IO': '🇮🇴', 'British Indian Ocean Territory': '🇮🇴', 'IQ': '🇮🇶', 'Iraq': '🇮🇶',
        'IR': '🇮🇷', 'Iran, Islamic Republic of': '🇮🇷', 'Iran': '🇮🇷',
        'IS': '🇮🇸', 'Iceland': '🇮🇸', 'IT': '🇮🇹', 'Italy': '🇮🇹', 'JE': '🇯🇪', 'Jersey': '🇯🇪',
        'JM': '🇯🇲', 'Jamaica': '🇯🇲', 'JO': '🇯🇴', 'Jordan': '🇯🇴', 'JP': '🇯🇵', 'Japan': '🇯🇵',
        'KE': '🇰🇪', 'Kenya': '🇰🇪', 'KG': '🇰🇬', 'Kyrgyzstan': '🇰🇬', 'KH': '🇰🇭', 'Cambodia': '🇰🇭',
        'KI': '🇰🇮', 'Kiribati': '🇰🇮', 'KM': '🇰🇲', 'Comoros': '🇰🇲',
        'KN': '🇰🇳', 'Saint Kitts and Nevis': '🇰🇳',
        'KP': '🇰🇵', "Korea, Democratic People's Republic of": '🇰🇵', 'North Korea': '🇰🇵',
        'KR': '🇰🇷', 'Korea, Republic of': '🇰🇷', 'South Korea': '🇰🇷',
        'KW': '🇰🇼', 'Kuwait': '🇰🇼', 'KY': '🇰🇾', 'Cayman Islands': '🇰🇾',
        'KZ': '🇰🇿', 'Kazakhstan': '🇰🇿', 'LA': '🇱🇦', "Lao People's Democratic Republic": '🇱🇦', 'Laos': '🇱🇦',
        'LB': '🇱🇧', 'Lebanon': '🇱🇧', 'LC': '🇱🇨', 'Saint Lucia': '🇱🇨',
        'LI': '🇱🇮', 'Liechtenstein': '🇱🇮', 'LK': '🇱🇰', 'Sri Lanka': '🇱🇰',
        'LR': '🇱🇷', 'Liberia': '🇱🇷', 'LS': '🇱🇸', 'Lesotho': '🇱🇸', 'LT': '🇱🇹', 'Lithuania': '🇱🇹',
        'LU': '🇱🇺', 'Luxembourg': '🇱🇺', 'LV': '🇱🇻', 'Latvia': '🇱🇻', 'LY': '🇱🇾', 'Libya': '🇱🇾',
        'MA': '🇲🇦', 'Morocco': '🇲🇦', 'MC': '🇲🇨', 'Monaco': '🇲🇨',
        'MD': '🇲🇩', 'Moldova, Republic of': '🇲🇩', 'Moldova': '🇲🇩',
        'ME': '🇲🇪', 'Montenegro': '🇲🇪', 'MF': '🇲🇫', 'Saint Martin (French part)': '🇲🇫',
        'MG': '🇲🇬', 'Madagascar': '🇲🇬', 'MH': '🇲🇭', 'Marshall Islands': '🇲🇭',
        'MK': '🇲🇰', 'North Macedonia': '🇲🇰', 'ML': '🇲🇱', 'Mali': '🇲🇱', 'MM': '🇲🇲', 'Myanmar': '🇲🇲', 'Burma': '🇲🇲',
        'MN': '🇲🇳', 'Mongolia': '🇲🇳', 'MO': '🇲🇴', 'Macao': '🇲🇴',
        'MP': '🇲🇵', 'Northern Mariana Islands': '🇲🇵', 'MQ': '🇲🇶', 'Martinique': '🇲🇶',
        'MR': '🇲🇷', 'Mauritania': '🇲🇷', 'MS': '🇲🇸', 'Montserrat': '🇲🇸', 'MT': '🇲🇹', 'Malta': '🇲🇹',
        'MU': '🇲🇺', 'Mauritius': '🇲🇺', 'MV': '🇲🇻', 'Maldives': '🇲🇻', 'MW': '🇲🇼', 'Malawi': '🇲🇼',
        'MX': '🇲🇽', 'Mexico': '🇲🇽', 'MY': '🇲🇾', 'Malaysia': '🇲🇾', 'MZ': '🇲🇿', 'Mozambique': '🇲🇿',
        'NA': '🇳🇦', 'Namibia': '🇳🇦', 'NC': '🇳🇨', 'New Caledonia': '🇳🇨', 'NE': '🇳🇪', 'Niger': '🇳🇪',
        'NF': '🇳🇫', 'Norfolk Island': '🇳🇫', 'NG': '🇳🇬', 'Nigeria': '🇳🇬',
        'NI': '🇳🇮', 'Nicaragua': '🇳🇮', 'NL': '🇳🇱', 'Netherlands': '🇳🇱', 'Holland': '🇳🇱',
        'NO': '🇳🇴', 'Norway': '🇳🇴', 'NP': '🇳🇵', 'Nepal': '🇳🇵', 'NR': '🇳🇷', 'Nauru': '🇳🇷',
        'NU': '🇳🇺', 'Niue': '🇳🇺', 'NZ': '🇳🇿', 'New Zealand': '🇳🇿', 'OM': '🇴🇲', 'Oman': '🇴🇲',
        'PA': '🇵🇦', 'Panama': '🇵🇦', 'PE': '🇵🇪', 'Peru': '🇵🇪', 'PF': '🇵🇫', 'French Polynesia': '🇵🇫',
        'PG': '🇵🇬', 'Papua New Guinea': '🇵🇬', 'PH': '🇵🇭', 'Philippines': '🇵🇭',
        'PK': '🇵🇰', 'Pakistan': '🇵🇰', 'PL': '🇵🇱', 'Poland': '🇵🇱',
        'PM': '🇵🇲', 'Saint Pierre and Miquelon': '🇵🇲', 'PN': '🇵🇳', 'Pitcairn': '🇵🇳',
        'PR': '🇵🇷', 'Puerto Rico': '🇵🇷', 'PS': '🇵🇸', 'Palestine, State of': '🇵🇸', 'Palestine': '🇵🇸',
        'PT': '🇵🇹', 'Portugal': '🇵🇹', 'PW': '🇵🇼', 'Palau': '🇵🇼', 'PY': '🇵🇾', 'Paraguay': '🇵🇾',
        'QA': '🇶🇦', 'Qatar': '🇶🇦', 'RE': '🇷🇪', 'Réunion': '🇷🇪', 'RO': '🇷🇴', 'Romania': '🇷🇴',
        'RS': '🇷🇸', 'Serbia': '🇷🇸', 'RU': '🇷🇺', 'Russian Federation': '🇷🇺', 'Russia': '🇷🇺',
        'RW': '🇷🇼', 'Rwanda': '🇷🇼', 'SA': '🇸🇦', 'Saudi Arabia': '🇸🇦',
        'SB': '🇸🇧', 'Solomon Islands': '🇸🇧', 'SC': '🇸🇨', 'Seychelles': '🇸🇨',
        'SD': '🇸🇩', 'Sudan': '🇸🇩', 'SE': '🇸🇪', 'Sweden': '🇸🇪', 'SG': '🇸🇬', 'Singapore': '🇸🇬',
        'SH': '🇸🇭', 'Saint Helena, Ascension and Tristan da Cunha': '🇸🇭',
        'SI': '🇸🇮', 'Slovenia': '🇸🇮', 'SJ': '🇸🇯', 'Svalbard and Jan Mayen': '🇸🇯',
        'SK': '🇸🇰', 'Slovakia': '🇸🇰', 'SL': '🇸🇱', 'Sierra Leone': '🇸🇱',
        'SM': '🇸🇲', 'San Marino': '🇸🇲', 'SN': '🇸🇳', 'Senegal': '🇸🇳', 'SO': '🇸🇴', 'Somalia': '🇸🇴',
        'SR': '🇸🇷', 'Suriname': '🇸🇷', 'SS': '🇸🇸', 'South Sudan': '🇸🇸',
        'ST': '🇸🇹', 'Sao Tome and Principe': '🇸🇹', 'SV': '🇸🇻', 'El Salvador': '🇸🇻',
        'SX': '🇸🇽', 'Sint Maarten (Dutch part)': '🇸🇽', 'SY': '🇸🇾', 'Syrian Arab Republic': '🇸🇾', 'Syria': '🇸🇾',
        'SZ': '🇸🇿', 'Eswatini': '🇸🇿', 'Swaziland': '🇸🇿',
        'TC': '🇹🇨', 'Turks and Caicos Islands': '🇹🇨', 'TD': '🇹🇩', 'Chad': '🇹🇩',
        'TF': '🇹🇫', 'French Southern Territories': '🇹🇫', 'TG': '🇹🇬', 'Togo': '🇹🇬',
        'TH': '🇹🇭', 'Thailand': '🇹🇭', 'TJ': '🇹🇯', 'Tajikistan': '🇹🇯', 'TK': '🇹🇰', 'Tokelau': '🇹🇰',
        'TL': '🇹🇱', 'Timor-Leste': '🇹🇱', 'East Timor': '🇹🇱',
        'TM': '🇹🇲', 'Turkmenistan': '🇹🇲', 'TN': '🇹🇳', 'Tunisia': '🇹🇳', 'TO': '🇹🇴', 'Tonga': '🇹🇴',
        'TR': '🇹🇷', 'Turkey': '🇹🇷', 'TT': '🇹🇹', 'Trinidad and Tobago': '🇹🇹',
        'TV': '🇹🇻', 'Tuvalu': '🇹🇻', 'TW': '🇹🇼', 'Taiwan, Province of China': '🇹🇼', 'Taiwan': '🇹🇼',
        'TZ': '🇹🇿', 'Tanzania, United Republic of': '🇹🇿', 'Tanzania': '🇹🇿',
        'UA': '🇺🇦', 'Ukraine': '🇺🇦', 'UG': '🇺🇬', 'Uganda': '🇺🇬',
        'UM': '🇺🇲', 'United States Minor Outlying Islands': '🇺🇲',
        'US': '🇺🇸', 'United States': '🇺🇸', 'USA': '🇺🇸', 'America': '🇺🇸',
        'UY': '🇺🇾', 'Uruguay': '🇺🇾', 'UZ': '🇺🇿', 'Uzbekistan': '🇺🇿',
        'VA': '🇻🇦', 'Holy See (Vatican City State)': '🇻🇦', 'Vatican City': '🇻🇦',
        'VC': '🇻🇨', 'Saint Vincent and the Grenadines': '🇻🇨',
        'VE': '🇻🇪', 'Venezuela, Bolivarian Republic of': '🇻🇪', 'Venezuela': '🇻🇪',
        'VG': '🇻🇬', 'Virgin Islands, British': '🇻🇬', 'VI': '🇻🇮', 'Virgin Islands, U.S.': '🇻🇮',
        'VN': '🇻🇳', 'Viet Nam': '🇻🇳', 'Vietnam': '🇻🇳',
        'VU': '🇻🇺', 'Vanuatu': '🇻🇺', 'WF': '🇼🇫', 'Wallis and Futuna': '🇼🇫',
        'WS': '🇼🇸', 'Samoa': '🇼🇸', 'XK': '🇽🇰', 'Kosovo': '🇽🇰', 'YE': '🇾🇪', 'Yemen': '🇾🇪',
        'YT': '🇾🇹', 'Mayotte': '🇾🇹', 'ZA': '🇿🇦', 'South Africa': '🇿🇦',
        'ZM': '🇿🇲', 'Zambia': '🇿🇲', 'ZW': '🇿🇼', 'Zimbabwe': '🇿🇼'
      };
      
      if (!country) return '🌐'; 
      const normalizedCountry = String(country).trim().toLowerCase();
      
      const upperCaseCountry = String(country).trim().toUpperCase();
      if (flagMap[upperCaseCountry]) {
          return flagMap[upperCaseCountry];
      }
      if (flagMap[String(country).trim()]) { 
          return flagMap[String(country).trim()];
      }
       for (const key in flagMap) {
        if (key.toLowerCase() === normalizedCountry) {
          return flagMap[key];
        }
      }
      
      const sortedKeys = Object.keys(flagMap).sort((a, b) => b.length - a.length);
      for (const key of sortedKeys) {
        if (key.length > 3 && normalizedCountry.includes(key.toLowerCase())) { 
          return flagMap[key];
        }
      }
      
      return '🌐'; 
    }

    const getResultsBtn = document.getElementById('getResultsBtn');
    const supportBtn = document.getElementById('supportBtn');

    if (getResultsBtn) {
        getResultsBtn.addEventListener('click', lookupUser);
    }
    if (supportBtn) {
        supportBtn.addEventListener('click', function() {
          window.open('https://ko-fi.com/moroccan', '_blank', 'noopener,noreferrer'); 
        });
    }

    function lookupUser() {
      const usernameInput = document.getElementById('username');
      const resultDiv = document.getElementById('result');
      const currentGetResultsBtn = document.getElementById('getResultsBtn'); 

      const username = usernameInput ? usernameInput.value.trim().replace(/^@/, '') : ''; 
      
      if (!username) {
        if(resultDiv) {
            resultDiv.innerHTML = '<div class="message error-message">Please enter a valid TikTok username.</div>';
            resultDiv.style.display = 'block'; 
        }
        return;
      }

      if(currentGetResultsBtn) currentGetResultsBtn.disabled = true;
      if(resultDiv) {
          resultDiv.innerHTML = '<div class="loading-spinner-container"><div class="loading-spinner"></div> Loading profile data...</div>';
          resultDiv.style.display = 'block'; 
      }
      
      const apiUrl = `https://corsproxy.io/?https://jaefu3p97g.execute-api.us-east-1.amazonaws.com/default/smttab?username=${encodeURIComponent(username)}`;
      console.log("Attempting to fetch data from:", apiUrl);

      fetch(apiUrl, { headers: { 'Origin': window.location.origin }}) 
        .then(response => {
          console.log("Received response status:", response.status);
          if (!response.ok) {
            return response.text().then(text => {
                let errorMsg = `API request failed (${response.status})`;
                if (response.status === 429) errorMsg = 'Rate limit exceeded from API. Please try again later.';
                else if (response.status === 404) errorMsg = 'User not found or API endpoint issue.';
                else if (response.status === 500 || response.status === 502 || response.status === 503 || response.status === 504) errorMsg = 'The API service seems to be down or experiencing issues. Please try again later.';
                else {
                    try {
                        const errData = JSON.parse(text);
                        errorMsg = errData.message || errData.error || text || errorMsg;
                    } catch (e) {
                        errorMsg = text || errorMsg;
                    }
                }
                console.error("API Error:", errorMsg, "Raw text:", text);
                throw new Error(errorMsg); 
            });
          }
          return response.json();
        })
        .then(data => {
          console.log("Full API Response Data:", JSON.stringify(data, null, 2));
          
          const apiProfile = data.profile; 

          if (apiProfile && typeof apiProfile === 'object' && Object.keys(apiProfile).length > 0) {
            const sanitize = (str) => {
                if (str === null || typeof str === 'undefined') return '';
                if (typeof str !== 'string') return String(str); 
                const temp = document.createElement('div');
                temp.textContent = str;
                return temp.innerHTML; 
            };

            let foundProfilePhotoUrl = '';
            const avatarKeys = ['Profile Photo', 'Avatar URL', 'avatar_url', 'avatarUrl', 'picture', 'profileImageUrl', 'profile_pic_url', 'avatarLarger', 'avatarMedium', 'avatarThumb'];
            for (const key of avatarKeys) {
                if (apiProfile[key] && typeof apiProfile[key] === 'string' && apiProfile[key].trim() !== '') {
                    foundProfilePhotoUrl = apiProfile[key];
                    console.log(`Found avatar URL using key: ${key}`);
                    break; 
                }
            }
            const profilePhotoHTML = foundProfilePhotoUrl 
                ? `<img src="${sanitize(foundProfilePhotoUrl)}" alt="Profile photo of ${sanitize(apiProfile.Nickname || apiProfile.Username || username)}" class="profile-photo-enhanced" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` 
                : '';
            const placeholderSVG = `<div class="profile-photo-placeholder" style="${foundProfilePhotoUrl ? 'display:none;' : 'display:flex;'}">
                                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                    </div>`;

            let rawUsernameFromAPI = apiProfile.Username || apiProfile.uniqueId || username; 
            if (typeof rawUsernameFromAPI === 'string' && rawUsernameFromAPI.startsWith('@')) {
                rawUsernameFromAPI = rawUsernameFromAPI.substring(1);
            }
            const displayUsername = sanitize(rawUsernameFromAPI);
            const displayNickname = sanitize(apiProfile.Nickname || apiProfile.nickname || displayUsername);


            let profileDetailsHtml = '';
            const displayOrder = ['Bio', 'Country', 'Followers', 'Following', 'Likes', 'Videos', 'Signature', 'Is Verified', 'Private Account']; 
            const processedKeys = new Set(['Nickname', 'Username', 'uniqueId', 'nickname', ...avatarKeys]);

            function formatNumber(num) {
                if (typeof num === 'number') return num.toLocaleString();
                if (typeof num === 'string' && !isNaN(parseFloat(num))) return parseFloat(num).toLocaleString();
                return sanitize(String(num));
            }
            
            for (const key of displayOrder) {
                let actualKey = key;
                if (!apiProfile[key]) {
                    const lowerKey = key.toLowerCase();
                    const foundApiProfileKey = Object.keys(apiProfile).find(k => k.toLowerCase() === lowerKey || k.toLowerCase() === lowerKey.replace(/\s/g, ''));
                    if (foundApiProfileKey) actualKey = foundApiProfileKey;
                }

                if (Object.hasOwnProperty.call(apiProfile, actualKey) && apiProfile[actualKey] != null && !processedKeys.has(actualKey)) {
                    let value = apiProfile[actualKey];
                    let displayKeyFormatted = actualKey.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()).trim();

                    if (actualKey.toLowerCase().includes('bio') || actualKey.toLowerCase().includes('signature')) {
                        value = sanitize(String(value)).replace(/\n/g, '<br>');
                         profileDetailsHtml += `<div class="profile-info-row bio-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><p class="info-value bio-text">${value || 'N/A'}</p></div>`;
                    } else if (actualKey.toLowerCase().includes('country') || actualKey.toLowerCase().includes('region')) {
                        value = sanitize(String(value));
                        profileDetailsHtml += `<div class="profile-info-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><span class="info-value">${getCountryFlag(value)} ${value || 'N/A'}</span></div>`;
                    } else if (typeof value === 'number' || (typeof value === 'string' && !isNaN(parseFloat(value)))) {
                         profileDetailsHtml += `<div class="profile-info-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><span class="info-value">${formatNumber(value)}</span></div>`;
                    } else if (typeof value === 'boolean') {
                        value = value ? 'Yes' : 'No';
                         profileDetailsHtml += `<div class="profile-info-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><span class="info-value">${value}</span></div>`;
                    } else {
                         profileDetailsHtml += `<div class="profile-info-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><span class="info-value">${sanitize(String(value)) || 'N/A'}</span></div>`;
                    }
                    processedKeys.add(actualKey);
                }
            }

            for (const key in apiProfile) {
                if (Object.hasOwnProperty.call(apiProfile, key) && apiProfile[key] != null && !processedKeys.has(key)) {
                     let value = apiProfile[key];
                    let displayKeyFormatted = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()).trim();
                    if (typeof value === 'boolean') value = value ? 'Yes' : 'No';
                    profileDetailsHtml += `<div class="profile-info-row"><span class="info-label">${sanitize(displayKeyFormatted)}:</span><span class="info-value">${sanitize(String(value)) || 'N/A'}</span></div>`;
                }
            }

            let formattedData = `
              <article class="profile-card" aria-labelledby="profile-card-heading-${displayUsername}">
                <h3 id="profile-card-heading-${displayUsername}" class="sr-only">Profile details for ${displayNickname}</h3>
                <div class="profile-card-header">
                  ${profilePhotoHTML}
                  ${placeholderSVG}
                  <div class="profile-identity">
                    <p class="profile-nickname" title="${sanitize(displayNickname)}">${displayNickname}</p>
                    <p class="profile-username-display" title="@${displayUsername}">@${displayUsername}</p> 
                  </div>
                </div>
                <div class="profile-card-body">
                  ${profileDetailsHtml || '<p class="info-value">No additional details available.</p>'}
                </div>
                <div class="profile-card-footer">
                  <span class="message success-message">Profile data retrieved successfully!</span>
                </div>
              </article>
            `;
            if(resultDiv) resultDiv.innerHTML = formattedData;
          } else {
            console.warn("Profile data ('data.profile') is missing, not an object, or empty in the API response.", "Received data:", data);
            if(resultDiv) resultDiv.innerHTML = '<div class="message error-message">User not found, profile is private, or no data returned from API. Please check the username and try again.</div>';
          }
        })
        .catch(error => {
          console.error("Fetch or processing error:", error);
          const sanitizedErrorMessage = error.message ? error.message.replace(/</g, "&lt;").replace(/>/g, "&gt;") : 'Failed to fetch profile data';
          if(resultDiv) resultDiv.innerHTML = `<div class="message error-message">Error: ${sanitizedErrorMessage}. Please check the username and try again. The API service might be temporarily unavailable.</div>`;
        })
        .finally(() => {
          if(currentGetResultsBtn) currentGetResultsBtn.disabled = false;
        });
    }

    const usernameInputGlobal = document.getElementById('username'); 
    if (usernameInputGlobal) {
      usernameInputGlobal.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault(); 
          lookupUser();
        }
      });
    }

    const srOnlyStyle = document.createElement('style');
    srOnlyStyle.textContent = `
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }
    `;
    document.head.appendChild(srOnlyStyle);

  </script>
</body>
</html>
